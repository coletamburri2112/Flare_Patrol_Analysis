

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Spectra Module &mdash; GBM Data Tools 1.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
        <script defer="defer" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulate Module" href="api-sims.html" />
    <link rel="prev" title="Background Estimation Module" href="api-background.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GBM Data Tools
          

          
            
            <img src="../_static/fermi_face.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/index.html">Jupyter Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">GBM Data Tools API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api-data.html">Data Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-binning.html">Data Binning Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-background.html">Background Estimation Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spectra Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectral-fitting">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectralfitter">SpectralFitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectralfitterchisq">SpectralFitterChisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="#chisq">chisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectralfittercstat">SpectralFitterCstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cstat">cstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectralfitterpgstat">SpectralFitterPgstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pgstat">pgstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectralfitterpstat">SpectralFitterPstat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pstat">pstat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-function-base-classes">Spectral Function Base Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#function">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#superfunction">SuperFunction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-functions">Spectral Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#powerlaw">PowerLaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="#comptonized">Comptonized</a></li>
<li class="toctree-l4"><a class="reference internal" href="#band">Band</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bandold">BandOld</a></li>
<li class="toctree-l4"><a class="reference internal" href="#brokenpowerlaw">BrokenPowerLaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="#doublebrokenpowerlaw">DoubleBrokenPowerLaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smoothlybrokenpowerlaw">SmoothlyBrokenPowerLaw</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lognormal">LogNormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gaussianlog">GaussianLog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gaussianlogvaryingfwhm">GaussianLogVaryingFWHM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sunyaevtitarchuk">SunyaevTitarchuk</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ottb">OTTB</a></li>
<li class="toctree-l4"><a class="reference internal" href="#otts">OTTS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#blackbody">BlackBody</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gaussline">GaussLine</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yangsoongpulsar">YangSoongPulsar</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tanakapulsar">TanakaPulsar</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lowenergycutoff">LowEnergyCutoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="#highenergycutoff">HighEnergyCutoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="#powerlawmult">PowerLawMult</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gausslinemult">GaussLineMult</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lorentzlinemult">LorentzLineMult</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api-sims.html">Simulate Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-plot.html">Plotting Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-finders.html">Data Finders</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Change Logs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GBM Data Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">GBM Data Tools API</a> &raquo;</li>
        
      <li>Spectra Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/api-spectra.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="spectra-module">
<span id="api-spectra"></span><h1>Spectra Module<a class="headerlink" href="#spectra-module" title="Permalink to this headline">¶</a></h1>
<p>The classes and methods in <code class="docutils literal notranslate"><span class="pre">gbm.spectra</span></code> are for spectral fitting.</p>
<div class="section" id="spectral-fitting">
<h2>Spectral Fitting<a class="headerlink" href="#spectral-fitting" title="Permalink to this headline">¶</a></h2>
<p>These classes and functions define the likelihood functions and
maximum-likelihood fitters associated with those functions.</p>
<div class="section" id="spectralfitter">
<h3>SpectralFitter<a class="headerlink" href="#spectralfitter" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">SpectralFitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgd_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsp_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SLSQP'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for jointly-fitting spectra from multiple detectors.
This is a (large) wrapper around <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a>.
This class should not be instantiated by the user, but instead a child class
for a specific fit statistic should be instantiated.</p>
<p>Child classes should be designed with the following requirements:</p>
<ol class="arabic simple">
<li><p>An <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method that takes in the inputs in the Parent <code class="docutils literal notranslate"><span class="pre">__init__</span></code>
method. Can have additional arguments/keywords.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">_fold_model</span></code> method that accepts the model function and the list of
parameters. It must return a single number that represents the likelihood
for a single detector/dataset.</p></li>
</ol>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pha_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.PHA" title="gbm.data.PHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHA</span></code></a>) – The PHA objects containg the count spectrum for each detector</p></li>
<li><p><strong>bkgd_list</strong> (list of <a class="reference internal" href="api-background.html#gbm.background.BackgroundRates" title="gbm.background.BackgroundRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundRates</span></code></a> or                    list of <a class="reference internal" href="api-background.html#gbm.background.BackgroundSpectrum" title="gbm.background.BackgroundSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundSpectrum</span></code></a>) – The background rates object for each detector or background spectrum
for each detector.  If given the background rates object, the times
in the corresponding PHA object will be used for the limits of
integration.</p></li>
<li><p><strong>rsp_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.RSP" title="gbm.data.RSP"><code class="xref py py-class docutils literal notranslate"><span class="pre">RSP</span></code></a>) – The response object for each detector</p></li>
<li><p><strong>statistic</strong> (<em>&lt;function&gt;</em>) – The function to be used as a fit statistic</p></li>
<li><p><strong>channel_masks</strong> (<em>list of np.array</em><em>(</em><em>dtype=bool</em><em>)</em><em>, </em><em>optional</em>) – <p>A boolean mask for each detector that indicates which energy
channels are to be fit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The channel_mask will typically be set by the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code> attribute in the PHA object.  You can
set channel_masks to override the PHA <code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code>,
but this is usually unnecessary.</p>
</div>
</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The fitting algorithm, which should be one of the options for
scipy.optimize.minimize. Note that ‘TNC’ and ‘SLSQP’ are the two
algorithms that provide support for fitting with bounds and
constraints.  Other algorithms will ignore bounds and constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul>
<li><p><strong>covariance</strong> (<em>np.array</em>) – The covariance matrix of the fitted parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the covariance matrix
may not be valid.</p>
</div>
</li>
<li><p><strong>detectors</strong> (<em>list of str</em>) – The detectors used in the fit</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – The number of degrees of freedom</p></li>
<li><p><strong>energy_range</strong> (<em>float, float</em>) – The full energy range of the fit</p></li>
<li><p><strong>function_components</strong> (<em>list of str</em>) – The names of the individual model
components, if appropriate</p></li>
<li><p><strong>function_name</strong> (<em>str</em>) – The name of the model function being fit</p></li>
<li><p><strong>hessian</strong> (<em>np.array</em>) – The Hessian matrix of the fitted parameters, for which the
covariance matrix is -inverse(Hessian).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the Hessian matrix may
not be valid.</p>
</div>
</li>
<li><p><strong>jacobian</strong> (<em>np.array</em>) – The Jacobian vector of the likelihood as a
function of the parameters.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The message from the fitter on convergence/non-convergence</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components</p></li>
<li><p><strong>num_sets</strong> (<em>int</em>) – Number of datasets/detectors being fit</p></li>
<li><p><strong>parameters</strong> (<em>np.array</em>) – The parameter values at the maximum likelihood</p></li>
<li><p><strong>statistic</strong> (<em>float</em>) – The fit statistic (likelihood)</p></li>
<li><p><strong>success</strong> (<em>bool</em>) – True if the fit was successful, False otherwise.</p></li>
<li><p><strong>symmetric_errors</strong> (<em>np.array</em>) – The 1-sigma uncertainty on the parameters assuming higher-order terms
of the Taylor expansion of the likelihood about the maximum
likelihood solution is negligible. If those terms are not negligible,
errors could be very incorrect or event NaN.
See attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">covariance</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">hessian</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.asymmetric_errors">
<span class="sig-name descname"><span class="pre">asymmetric_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.683</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.asymmetric_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.asymmetric_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the asymmetric uncertainty on each fitted parameter.
This function uses <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brentq.html">scipy.optimize.brentq</a></p>
<blockquote>
<div><p>to find the root of:</p>
</div></blockquote>
<p>crit = -2(LL_max-LL),</p>
<p>where <em>crit</em> is the chi-square critical value defined by the number of
free parameters and the confidence level, and <em>LL_max</em> is the maximum
log-likelihood.  The brentq function uses a bracketing range to find the
roots, and this function uses the best-fit values of the parameters for
one side of the bracket and the min/max values defined in the fitted
function for the other side of the bracket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cl</strong> (<em>float</em><em>, </em><em>optional</em>) – The confidence level of the uncertainties.
Default is 0.683 (1 sigma).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array</em> – A (<code class="docutils literal notranslate"><span class="pre">nparams</span></code>, 2) array where each row reprensents the                   (negative, positive) uncertainty on each parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.data_count_spectrum">
<span class="sig-name descname"><span class="pre">data_count_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upper_limits_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.data_count_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.data_count_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>The observed source count spectrum, which is (total-background).
Data bins with source counts less than the model variance are converted
to upper limits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>upper_limits_sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – The upper limits sigma.
Default is 2.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>tuple</em> – A 5-tuple containing:</p>
<ul class="simple">
<li><p><em>list of np.array</em>: Energy centroids</p></li>
<li><p><em>list of np.array</em>: Energy channel widths</p></li>
<li><p><em>list of np.array</em>: differential count spectrum</p></li>
<li><p><em>list of np.array</em>: 1-sigma count spectrum errors</p></li>
<li><p><em>list of np.array</em>: Upper limits boolean mask</p></li>
</ul>
<p>for each dataset. The upper limits mask is a boolean mask where
True indicates the element is an upper limit.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the given the function to the data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – The function object to use</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to the fitter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a fitter object that has been saved to disk in a compressed
numpy file.  Thanks to the cool properties of the numpy format, this
method will load the complete state of the fitter when it was saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The complete filename of the saved file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.model_count_spectrum">
<span class="sig-name descname"><span class="pre">model_count_spectrum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.model_count_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.model_count_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>The fitted model count spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="api-data.html#gbm.data.primitives.EnergyBins" title="gbm.data.primitives.EnergyBins"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyBins</span></code></a> – An EnergyBins                                                          object for each dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.model_variance">
<span class="sig-name descname"><span class="pre">model_variance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.model_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.model_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>The differential source model variance, accounting for the data variance
and background model variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>list of np.array</em> – The model variance for each dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.residuals">
<span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.residuals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>The fit residuals for each dataset in units of differential
counts or model sigma</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sigma</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return in units of model sigma,
otherwise return in units of differential counts. Default is True.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>tuple</em> – A 4-tuple containing:</p>
<ul class="simple">
<li><p><em>list of np.array</em>: Energy centroids</p></li>
<li><p><em>list of np.array</em>: Energy channel widths</p></li>
<li><p><em>list of np.array</em>: Fit residuals</p></li>
<li><p><em>list of np.array</em>: Residual uncertainties</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.sample_flux">
<span class="sig-name descname"><span class="pre">sample_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">erange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.sample_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.sample_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce samples of the energy-integrated photon or energy flux.
This uses the covariance matrix and assumes a multivariate normal
distribuion for the parameters.  Caveat Emptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>erange</strong> (<em>float</em><em>, </em><em>float</em>) – Which spectrum to return. Either ‘photon’,
‘energy’, or ‘nufnu’</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – The number of spectra to sample. Default is 1000.</p></li>
<li><p><strong>numpoints</strong> (<em>int</em>) – The number of grid points in energy. Default is 1000.</p></li>
<li><p><strong>**kwargs</strong> – Options to be passed to
<a class="reference internal" href="#gbm.spectra.functions.Function.integrate" title="gbm.spectra.functions.Function.integrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array</em> – The sampled flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.sample_parameters">
<span class="sig-name descname"><span class="pre">sample_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.sample_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.sample_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce samples of the fitted parameters.  This uses the covariance
matrix and assumes a multivariate normal distribuion.  Caveat Emptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Options (like size) to be passed to numpy.random.multivariate_normal</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array</em> – The random parameter samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.sample_spectrum">
<span class="sig-name descname"><span class="pre">sample_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.sample_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.sample_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce samples of the model photon, energy, or <span class="math notranslate nohighlight">\(\nu F_\nu\)</span>
spectrum. This uses the covariance matrix and assumes a multivariate
normal distribuion for the parameters. Caveat Emptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<em>str</em>) – Which spectrum to return.
Either ‘photon’, ‘energy’, or ‘nufnu’</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of spectrum to sample.
Default is 1000.</p></li>
<li><p><strong>numpoints</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of grid points in energy.
Default is 1000.</p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, calculate the spectrum for each individual model
components (if there are multiple components). Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>tuple</em> – A 2-tuple containing:</p>
<ul class="simple">
<li><p><em>np.array</em>: The energy grid at which the spectrum is calculated</p></li>
<li><p><em>np.array</em>: Array of shape (<code class="docutils literal notranslate"><span class="pre">num_samples</span></code>, <code class="docutils literal notranslate"><span class="pre">numpoints</span></code>) if
there is only one component or
(<code class="docutils literal notranslate"><span class="pre">num_samples</span></code>, <code class="docutils literal notranslate"><span class="pre">num_components</span></code>, <code class="docutils literal notranslate"><span class="pre">numpoints</span></code>) if there
are multiple components.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the fitter object to a compressed binary numpy file. The full
state of the fitter is serialized and saved, and it can be restored
using the <a class="reference internal" href="#gbm.spectra.fitting.SpectralFitter.load" title="gbm.spectra.fitting.SpectralFitter.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The complete filename to save the fitter object to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitter.spectrum">
<span class="sig-name descname"><span class="pre">spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitter.spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitter.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>The model photon, energy, or <span class="math notranslate nohighlight">\(\nu F_\nu\)</span> spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<em>str</em>) – Which spectrum to return.
Either ‘photon’, ‘energy’, or ‘nufnu’</p></li>
<li><p><strong>numpoints</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of grid points in energy.
Default is 1000.</p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, calculate the spectrum for each individual model
components (if there are multiple components). Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>tuple</em> – A 2-tuple containing:</p>
<ul class="simple">
<li><p><em>np.array</em>: The energy grid at which the spectrum is calculated</p></li>
<li><p><em>np.array</em> or <em>list of np.array</em>: model spectrum values, or
spectrum values for each component</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="spectralfitterchisq">
<h3>SpectralFitterChisq<a class="headerlink" href="#spectralfitterchisq" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitterChisq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">SpectralFitterChisq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgd_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsp_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitterChisq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitterChisq" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.fitting.SpectralFitter" title="gbm.spectra.fitting.SpectralFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.fitting.SpectralFitter</span></code></a></p>
<p>Jointly-fit datasets using Chi-Squared Likelihood.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pha_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.PHA" title="gbm.data.PHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHA</span></code></a>) – The PHA objects containg the count spectrum for each detector</p></li>
<li><p><strong>bkgd_list</strong> (list of <a class="reference internal" href="api-background.html#gbm.background.BackgroundRates" title="gbm.background.BackgroundRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundRates</span></code></a>) – The background rates object for each detector</p></li>
<li><p><strong>rsp_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.RSP" title="gbm.data.RSP"><code class="xref py py-class docutils literal notranslate"><span class="pre">RSP</span></code></a>) – The response object for each detector</p></li>
<li><p><strong>channel_masks</strong> (<em>list of np.array</em><em>(</em><em>dtype=bool</em><em>)</em><em>, </em><em>optional</em>) – <p>A boolean mask for each detector that indicates which energy
channels are to be fit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The channel_mask will typically be set by the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code> attribute in the PHA object.  You can
set channel_masks to override the PHA <code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code>,
but this is usually unnecessary.</p>
</div>
</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The fitting algorithm, which should be one of the options for
scipy.optimize.minimize. Note that ‘TNC’ and ‘SLSQP’ are the two
algorithms that provide support for fitting with bounds and
constraints.  Other algorithms will ignore bounds and constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul>
<li><p><strong>covariance</strong> (<em>np.array</em>) – The covariance matrix of the fitted parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the covariance matrix
may not be valid.</p>
</div>
</li>
<li><p><strong>detectors</strong> (<em>list of str</em>) – The detectors used in the fit</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – The number of degrees of freedom</p></li>
<li><p><strong>energy_range</strong> (<em>float, float</em>) – The full energy range of the fit</p></li>
<li><p><strong>function_components</strong> (<em>list of str</em>) – The names of the individual model
components, if appropriate</p></li>
<li><p><strong>function_name</strong> (<em>str</em>) – The name of the model function being fit</p></li>
<li><p><strong>hessian</strong> (<em>np.array</em>) – The Hessian matrix of the fitted parameters, for which the
covariance matrix is -inverse(Hessian).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the Hessian matrix may
not be valid.</p>
</div>
</li>
<li><p><strong>jacobian</strong> (<em>np.array</em>) – The Jacobian vector of the likelihood as a
function of the parameters.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The message from the fitter on convergence/non-convergence</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components</p></li>
<li><p><strong>num_sets</strong> (<em>int</em>) – Number of datasets/detectors being fit</p></li>
<li><p><strong>parameters</strong> (<em>np.array</em>) – The parameter values at the maximum likelihood</p></li>
<li><p><strong>statistic</strong> (<em>float</em>) – The fit statistic (likelihood)</p></li>
<li><p><strong>success</strong> (<em>bool</em>) – True if the fit was successful, False otherwise.</p></li>
<li><p><strong>symmetric_errors</strong> (<em>np.array</em>) – The 1-sigma uncertainty on the parameters assuming higher-order terms
of the Taylor expansion of the likelihood about the maximum
likelihood solution is negligible. If those terms are not negligible,
errors could be very incorrect or event NaN.
See attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">covariance</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">hessian</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="chisq">
<h3>chisq<a class="headerlink" href="#chisq" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="gbm.spectra.fitting.chisq">
<span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">chisq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#chisq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.chisq" title="Permalink to this definition">¶</a></dt>
<dd><p>Chi-Square Likelihood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_counts</strong> (<em>np.array</em>) – The total observed counts</p></li>
<li><p><strong>back_rates</strong> (<em>np.array</em>) – The background model count rates</p></li>
<li><p><strong>back_var</strong> (<em>np.array</em>) – The background model count rate variance</p></li>
<li><p><strong>mod_rates</strong> (<em>np.array</em>) – The model source rates</p></li>
<li><p><strong>exposure</strong> (<em>float</em>) – The source exposure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The chi-squared statistic</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spectralfittercstat">
<h3>SpectralFitterCstat<a class="headerlink" href="#spectralfittercstat" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitterCstat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">SpectralFitterCstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgd_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsp_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitterCstat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitterCstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.fitting.SpectralFitter" title="gbm.spectra.fitting.SpectralFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.fitting.SpectralFitter</span></code></a></p>
<p>Jointly-fit datasets using C-Stat (Poisson source with Poisson background)</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pha_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.PHA" title="gbm.data.PHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHA</span></code></a>) – The PHA objects containg the count spectrum for each detector</p></li>
<li><p><strong>bkgd_list</strong> (list of <a class="reference internal" href="api-background.html#gbm.background.BackgroundRates" title="gbm.background.BackgroundRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundRates</span></code></a>) – The background rates object for each detector</p></li>
<li><p><strong>rsp_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.RSP" title="gbm.data.RSP"><code class="xref py py-class docutils literal notranslate"><span class="pre">RSP</span></code></a>) – The response object for each detector</p></li>
<li><p><strong>channel_masks</strong> (<em>list of np.array</em><em>(</em><em>dtype=bool</em><em>)</em><em>, </em><em>optional</em>) – <p>A boolean mask for each detector that indicates which energy
channels are to be fit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The channel_mask will typically be set by the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code> attribute in the PHA object.  You can
set channel_masks to override the PHA <code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code>,
but this is usually unnecessary.</p>
</div>
</p></li>
<li><p><strong>back_exp</strong> (<em>list of float</em><em>, </em><em>optional</em>) – Set if different than the source
exposure</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The fitting algorithm, which should be one of the options for
scipy.optimize.minimize. Note that ‘TNC’ and ‘SLSQP’ are the two
algorithms that provide support for fitting with bounds and
constraints.  Other algorithms will ignore bounds and constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul>
<li><p><strong>covariance</strong> (<em>np.array</em>) – The covariance matrix of the fitted parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the covariance matrix
may not be valid.</p>
</div>
</li>
<li><p><strong>detectors</strong> (<em>list of str</em>) – The detectors used in the fit</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – The number of degrees of freedom</p></li>
<li><p><strong>energy_range</strong> (<em>float, float</em>) – The full energy range of the fit</p></li>
<li><p><strong>function_components</strong> (<em>list of str</em>) – The names of the individual model
components, if appropriate</p></li>
<li><p><strong>function_name</strong> (<em>str</em>) – The name of the model function being fit</p></li>
<li><p><strong>hessian</strong> (<em>np.array</em>) – The Hessian matrix of the fitted parameters, for which the
covariance matrix is -inverse(Hessian).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the Hessian matrix may
not be valid.</p>
</div>
</li>
<li><p><strong>jacobian</strong> (<em>np.array</em>) – The Jacobian vector of the likelihood as a
function of the parameters.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The message from the fitter on convergence/non-convergence</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components</p></li>
<li><p><strong>num_sets</strong> (<em>int</em>) – Number of datasets/detectors being fit</p></li>
<li><p><strong>parameters</strong> (<em>np.array</em>) – The parameter values at the maximum likelihood</p></li>
<li><p><strong>statistic</strong> (<em>float</em>) – The fit statistic (likelihood)</p></li>
<li><p><strong>success</strong> (<em>bool</em>) – True if the fit was successful, False otherwise.</p></li>
<li><p><strong>symmetric_errors</strong> (<em>np.array</em>) – The 1-sigma uncertainty on the parameters assuming higher-order terms
of the Taylor expansion of the likelihood about the maximum
likelihood solution is negligible. If those terms are not negligible,
errors could be very incorrect or event NaN.
See attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">covariance</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">hessian</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="cstat">
<h3>cstat<a class="headerlink" href="#cstat" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="gbm.spectra.fitting.cstat">
<span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">cstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_exp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#cstat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.cstat" title="Permalink to this definition">¶</a></dt>
<dd><p>C-Statistic Likelihood for Poisson source + Poisson background.
The “W” statistic from the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSappendixStatistics.html">XSPEC Statistics Appendix</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_counts</strong> (<em>np.array</em>) – The total observed counts</p></li>
<li><p><strong>mod_rates</strong> (<em>np.array</em>) – The model source rates</p></li>
<li><p><strong>exposure</strong> (<em>float</em>) – The source exposure</p></li>
<li><p><strong>back_counts</strong> (<em>np.array</em>) – The background model counts</p></li>
<li><p><strong>back_exp</strong> (<em>float</em>) – The background exposure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The C-statistic</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spectralfitterpgstat">
<h3>SpectralFitterPgstat<a class="headerlink" href="#spectralfitterpgstat" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitterPgstat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">SpectralFitterPgstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgd_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsp_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitterPgstat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitterPgstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.fitting.SpectralFitter" title="gbm.spectra.fitting.SpectralFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.fitting.SpectralFitter</span></code></a></p>
<p>Jointly-fit datasets using Profile Gaussian likelihood (PGSTAT).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pha_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.PHA" title="gbm.data.PHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHA</span></code></a>) – The PHA objects containg the count spectrum for each detector</p></li>
<li><p><strong>bkgd_list</strong> (list of <a class="reference internal" href="api-background.html#gbm.background.BackgroundRates" title="gbm.background.BackgroundRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundRates</span></code></a>) – The background rates object for each detector</p></li>
<li><p><strong>rsp_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.RSP" title="gbm.data.RSP"><code class="xref py py-class docutils literal notranslate"><span class="pre">RSP</span></code></a>) – The response object for each detector</p></li>
<li><p><strong>channel_masks</strong> (<em>list of np.array</em><em>(</em><em>dtype=bool</em><em>)</em><em>, </em><em>optional</em>) – <p>A boolean mask for each detector that indicates which energy
channels are to be fit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The channel_mask will typically be set by the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code> attribute in the PHA object.  You can
set channel_masks to override the PHA <code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code>,
but this is usually unnecessary.</p>
</div>
</p></li>
<li><p><strong>back_exp</strong> (<em>list of float</em><em>, </em><em>optional</em>) – Set if different than the source
exposure</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The fitting algorithm, which should be one of the options for
scipy.optimize.minimize. Note that ‘TNC’ and ‘SLSQP’ are the two
algorithms that provide support for fitting with bounds and
constraints.  Other algorithms will ignore bounds and constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul>
<li><p><strong>covariance</strong> (<em>np.array</em>) – The covariance matrix of the fitted parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the covariance matrix
may not be valid.</p>
</div>
</li>
<li><p><strong>detectors</strong> (<em>list of str</em>) – The detectors used in the fit</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – The number of degrees of freedom</p></li>
<li><p><strong>energy_range</strong> (<em>float, float</em>) – The full energy range of the fit</p></li>
<li><p><strong>function_components</strong> (<em>list of str</em>) – The names of the individual model
components, if appropriate</p></li>
<li><p><strong>function_name</strong> (<em>str</em>) – The name of the model function being fit</p></li>
<li><p><strong>hessian</strong> (<em>np.array</em>) – The Hessian matrix of the fitted parameters, for which the
covariance matrix is -inverse(Hessian).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the Hessian matrix may
not be valid.</p>
</div>
</li>
<li><p><strong>jacobian</strong> (<em>np.array</em>) – The Jacobian vector of the likelihood as a
function of the parameters.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The message from the fitter on convergence/non-convergence</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components</p></li>
<li><p><strong>num_sets</strong> (<em>int</em>) – Number of datasets/detectors being fit</p></li>
<li><p><strong>parameters</strong> (<em>np.array</em>) – The parameter values at the maximum likelihood</p></li>
<li><p><strong>statistic</strong> (<em>float</em>) – The fit statistic (likelihood)</p></li>
<li><p><strong>success</strong> (<em>bool</em>) – True if the fit was successful, False otherwise.</p></li>
<li><p><strong>symmetric_errors</strong> (<em>np.array</em>) – The 1-sigma uncertainty on the parameters assuming higher-order terms
of the Taylor expansion of the likelihood about the maximum
likelihood solution is negligible. If those terms are not negligible,
errors could be very incorrect or event NaN.
See attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">covariance</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">hessian</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="pgstat">
<h3>pgstat<a class="headerlink" href="#pgstat" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="gbm.spectra.fitting.pgstat">
<span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">pgstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_exp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#pgstat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.pgstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Profile Gaussian Likelihood. From the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSappendixStatistics.html">XSPEC Statistics Appendix</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_counts</strong> (<em>np.array</em>) – The total observed counts</p></li>
<li><p><strong>mod_rates</strong> (<em>np.array</em>) – The model source rates</p></li>
<li><p><strong>exposure</strong> (<em>float</em>) – The source exposure</p></li>
<li><p><strong>back_counts</strong> (<em>np.array</em>) – The background model counts</p></li>
<li><p><strong>back_var</strong> (<em>np.array</em>) – The background model count variance</p></li>
<li><p><strong>back_exp</strong> (<em>float</em>) – The background exposure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The PG-stat</p>
</dd>
</dl>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="spectralfitterpstat">
<h3>SpectralFitterPstat<a class="headerlink" href="#spectralfitterpstat" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.fitting.SpectralFitterPstat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">SpectralFitterPstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgd_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsp_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#SpectralFitterPstat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.SpectralFitterPstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.fitting.SpectralFitter" title="gbm.spectra.fitting.SpectralFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.fitting.SpectralFitter</span></code></a></p>
<p>Jointly-fit datasets using P-Stat (Poisson source with known background).
This statistic assumes non-zero counts, therefore any channels with zero
counts will be masked out and not used in fitting.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pha_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.PHA" title="gbm.data.PHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">PHA</span></code></a>) – The PHA objects containg the count spectrum for each detector</p></li>
<li><p><strong>bkgd_list</strong> (list of <a class="reference internal" href="api-background.html#gbm.background.BackgroundRates" title="gbm.background.BackgroundRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundRates</span></code></a>) – The background rates object for each detector</p></li>
<li><p><strong>rsp_list</strong> (list of <a class="reference internal" href="api-data.html#gbm.data.RSP" title="gbm.data.RSP"><code class="xref py py-class docutils literal notranslate"><span class="pre">RSP</span></code></a>) – The response object for each detector</p></li>
<li><p><strong>channel_masks</strong> (<em>list of np.array</em><em>(</em><em>dtype=bool</em><em>)</em><em>, </em><em>optional</em>) – <p>A boolean mask for each detector that indicates which energy
channels are to be fit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The channel_mask will typically be set by the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code> attribute in the PHA object.  You can
set channel_masks to override the PHA <code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_channels</span></code>,
but this is usually unnecessary.</p>
</div>
</p></li>
<li><p><strong>back_exp</strong> (<em>list of float</em><em>, </em><em>optional</em>) – Set if different than the source
exposure</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – The fitting algorithm, which should be one of the options for
scipy.optimize.minimize. Note that ‘TNC’ and ‘SLSQP’ are the two
algorithms that provide support for fitting with bounds and
constraints.  Other algorithms will ignore bounds and constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul>
<li><p><strong>covariance</strong> (<em>np.array</em>) – The covariance matrix of the fitted parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the covariance matrix
may not be valid.</p>
</div>
</li>
<li><p><strong>detectors</strong> (<em>list of str</em>) – The detectors used in the fit</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – The number of degrees of freedom</p></li>
<li><p><strong>energy_range</strong> (<em>float, float</em>) – The full energy range of the fit</p></li>
<li><p><strong>function_components</strong> (<em>list of str</em>) – The names of the individual model
components, if appropriate</p></li>
<li><p><strong>function_name</strong> (<em>str</em>) – The name of the model function being fit</p></li>
<li><p><strong>hessian</strong> (<em>np.array</em>) – The Hessian matrix of the fitted parameters, for which the
covariance matrix is -inverse(Hessian).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The assumption of negligible higher-order terms in the Taylor
expansion may not be valid and therefore the Hessian matrix may
not be valid.</p>
</div>
</li>
<li><p><strong>jacobian</strong> (<em>np.array</em>) – The Jacobian vector of the likelihood as a
function of the parameters.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The message from the fitter on convergence/non-convergence</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components</p></li>
<li><p><strong>num_sets</strong> (<em>int</em>) – Number of datasets/detectors being fit</p></li>
<li><p><strong>parameters</strong> (<em>np.array</em>) – The parameter values at the maximum likelihood</p></li>
<li><p><strong>statistic</strong> (<em>float</em>) – The fit statistic (likelihood)</p></li>
<li><p><strong>success</strong> (<em>bool</em>) – True if the fit was successful, False otherwise.</p></li>
<li><p><strong>symmetric_errors</strong> (<em>np.array</em>) – The 1-sigma uncertainty on the parameters assuming higher-order terms
of the Taylor expansion of the likelihood about the maximum
likelihood solution is negligible. If those terms are not negligible,
errors could be very incorrect or event NaN.
See attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">covariance</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">hessian</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="pstat">
<h3>pstat<a class="headerlink" href="#pstat" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="gbm.spectra.fitting.pstat">
<span class="sig-prename descclassname"><span class="pre">gbm.spectra.fitting.</span></span><span class="sig-name descname"><span class="pre">pstat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back_rates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/fitting.html#pstat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.fitting.pstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Likelihood for Poisson source + known background.
The “pstat” statistic from the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSappendixStatistics.html">XSPEC Statistics Appendix</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Elements with zero counts are masked out and not figured in the
statistic.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_counts</strong> (<em>np.array</em>) – The total observed counts</p></li>
<li><p><strong>mod_rates</strong> (<em>np.array</em>) – The model source rates</p></li>
<li><p><strong>exposure</strong> (<em>float</em>) – The source exposure</p></li>
<li><p><strong>back_rates</strong> (<em>np.array</em>) – The background model count rates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The C-statistic</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<hr class="docutils" />
<div class="section" id="spectral-function-base-classes">
<h2>Spectral Function Base Classes<a class="headerlink" href="#spectral-function-base-classes" title="Permalink to this headline">¶</a></h2>
<p>The base classes represent photon model functions with metadata that allow these
functions to be fit to data.  Specifically, <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>
is the base class for all functions and <a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a>
inherits from <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> and is the base class
for either a sum or product of functions.</p>
<div class="section" id="function">
<h3>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">Function</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract class for a 1-D function (e.g. photon model).</p>
<p>Sub-classes should be designed with the following requirements:</p>
<ol class="arabic simple">
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">nparams</span></code> containing the total number of parameters of the
function (even parameters that are fixed to a particular value during fitting)</p></li>
<li><p>Method <a class="reference internal" href="#gbm.spectra.functions.Function.eval" title="gbm.spectra.functions.Function.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> that accepts two arguments: an array of parameter values
of length <code class="xref py py-attr docutils literal notranslate"><span class="pre">nparams</span></code>; and the array of abscissa values.</p></li>
</ol>
<p>Sub-classes can optionally add the following for complete and enhanced
functionality:</p>
<ol class="arabic simple">
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">param_list</span></code> that is a list of parameter names in the order
they are accepted in the <a class="reference internal" href="#gbm.spectra.functions.Function.eval" title="gbm.spectra.functions.Function.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> method. Each entry in <code class="xref py py-attr docutils literal notranslate"><span class="pre">param_list</span></code> is
a tuple of the form (&lt;param_name&gt;, &lt;units&gt;, &lt;description&gt;).  If no units
or description are needed, those fields should be a null string ‘’. If
omitted, these will be filled to default values (‘param0’, ‘’, ‘’), etc.</p></li>
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">default_values</span></code> that is a list of default parameter values.
This is primarily used for parameter estimation. Default is 1.0 for each
parameter</p></li>
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">delta_abs</span></code> that is a list of max absolute fitting step for
each parameter.  This is used for parameter estimation. Default is 0.1
for each parameter.</p></li>
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">delta_rel</span></code> that is a list of max relative fitting step for
each parameter.  This is used for paramter estimation.  Default is 0.01
for each parameter.</p></li>
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">min_values</span></code> that is a list of minimum values each parameter
can take.  This is used primarily for parameter estimation. Default is
-np.inf for each parameter.</p></li>
</ol>
<ol class="arabic simple" start="6">
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_values</span></code> that is a list of maximum values each parameter
can take.  This is used primarily for parameter estimation. Default is
np.inf for each parameter.</p></li>
<li><p>Attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">free</span></code> that is a boolean list indicating if each parameter
is allowed to be free for fitting.  False indicates that the parameter
will be fixed at its default value. This is used for parameter estimation.
Default is True for each parameter.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>default_values</strong> (<em>list</em>) – The default values for each parameter.
If not defined, each defaults to 1.0</p></li>
<li><p><strong>delta_abs</strong> (<em>list</em>) – The maximum absolute fitting step size for each
parameter. If not defined, each default to 0.1</p></li>
<li><p><strong>delta_rel</strong> (<em>list</em>) – The maximum relative fitting step size for each
parameter. If not defined, each default to 0.01</p></li>
<li><p><strong>free</strong> (<em>list</em>) – For each parameter, mark True if left free for fitting,
otherwise mark False to fix at the default value.
If not defined, each default to True.</p></li>
<li><p><strong>max_values</strong> (<em>list</em>) – The maximum possible value for each parameter.
If not defined, each default to np.inf</p></li>
<li><p><strong>min_values</strong> (<em>list</em>) – The minimum possible value for each parameter.
If not defined, each default to -np.inf</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the function</p></li>
<li><p><strong>nparams</strong> (<em>int</em>) – Number of parameters in the function.</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components. For a normal
function this is one, for a <a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a>,
this can be &gt; 1.</p></li>
<li><p><strong>param_list</strong> (<em>list of 3-tuples</em>) – A list of tuples corresponding to the metadata for the
parameters: (&lt;param_name&gt;, &lt;units&gt;, &lt;description&gt;)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function.add">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two Functions. Can also use the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func1</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function</p></li>
<li><p><strong>func2</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function to add to <code class="docutils literal notranslate"><span class="pre">func1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a> – A function containing the sum of the two functions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – The parameter vector of the free parameters</p></li>
<li><p><strong>x</strong> (<em>np.array</em>) – The values at which to evaluate the function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array</em> – The function evaluated at the <code class="docutils literal notranslate"><span class="pre">x</span></code> points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function.fit_eval">
<span class="sig-name descname"><span class="pre">fit_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function.fit_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function.fit_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the function for a fit.  This differs from the <a class="reference internal" href="#gbm.spectra.functions.Function.eval" title="gbm.spectra.functions.Function.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a>
because the <code class="docutils literal notranslate"><span class="pre">params</span></code> vector should only contain the free fit parameters.
The parameters that are set to fixed will automatically be passed to
<a class="reference internal" href="#gbm.spectra.functions.Function.eval" title="gbm.spectra.functions.Function.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> at their fixed value.  This enables a fit to be performed
withfixed parameters and the associated jacobian and covariance matrices
will have the appropriate shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – The parameter vector of the free parameters</p></li>
<li><p><strong>x</strong> (<em>np.array</em>) – The values at which to evaluate the function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array</em> – The function evaluated at the <code class="docutils literal notranslate"><span class="pre">x</span></code> points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function.integrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate the function over energy to produce a flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – The parameter vector, which can be of length
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nparams</span></code> or equal to the length of the
non-fixed (free) parameters.</p></li>
<li><p><strong>erange</strong> (<em>float</em><em>, </em><em>float</em>) – The energy range over which to integrate</p></li>
<li><p><strong>num_points</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of points used for
integration. Default is 1000.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the integration grid is made in
log-space, False it is linear. Default is True.</p></li>
<li><p><strong>energy</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform integration of E*F(E) to
produce an energy flux, otherwise
integration is over F(E) to produce a
photon flux. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The photon or energy flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function.multiply">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function.multiply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function.multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply two Functions. Can also use the <code class="docutils literal notranslate"><span class="pre">*</span></code> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func1</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function</p></li>
<li><p><strong>func2</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function to multiply to <code class="docutils literal notranslate"><span class="pre">func1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a> – A function containing the product of the                 two functions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.Function.parameter_bounds">
<span class="sig-name descname"><span class="pre">parameter_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apply_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Function.parameter_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Function.parameter_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>The valid parameter bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>apply_state</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will only return the bounds for free parameters.
Default is True.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>[(float, float), …]</em> – The list of bounds [(min, max), …]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="superfunction">
<h3>SuperFunction<a class="headerlink" href="#superfunction" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">SuperFunction</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#SuperFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.SuperFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Abstract class for a sum or product of functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>default_values</strong> (<em>list</em>) – The default values for each parameter.
If not defined, each defaults to 1.0</p></li>
<li><p><strong>delta_abs</strong> (<em>list</em>) – The maximum absolute fitting step size for each
parameter. If not defined, each default to 0.1</p></li>
<li><p><strong>delta_rel</strong> (<em>list</em>) – The maximum relative fitting step size for each
parameter. If not defined, each default to 0.01</p></li>
<li><p><strong>free</strong> (<em>list</em>) – For each parameter, mark True if left free for fitting,
otherwise mark False to fix at the default value.
If not defined, each default to True.</p></li>
<li><p><strong>max_values</strong> (<em>list</em>) – The maximum possible value for each parameter.
If not defined, each default to np.inf</p></li>
<li><p><strong>min_values</strong> (<em>list</em>) – The minimum possible value for each parameter.
If not defined, each default to -np.inf</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the function</p></li>
<li><p><strong>nparams</strong> (<em>int</em>) – Number of parameters in the function.</p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – Number of function components. For a normal
function this is one, for a <a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a>,
this can be &gt; 1.</p></li>
<li><p><strong>param_list</strong> (<em>list of 3-tuples</em>) – A list of tuples corresponding to the metadata for the
parameters: (&lt;param_name&gt;, &lt;units&gt;, &lt;description&gt;)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction.add">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbm.spectra.functions.SuperFunction.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two Functions. Can also use the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func1</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function</p></li>
<li><p><strong>func2</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function to add to <code class="docutils literal notranslate"><span class="pre">func1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a> – A function containing the sum of the two functions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#SuperFunction.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.SuperFunction.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – The parameter vector of the free parameters</p></li>
<li><p><strong>x</strong> (<em>np.array</em>) – The values at which to evaluate the function</p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, evaluate for each component.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array or list of np.array</em> –     The function evaluated at <code class="docutils literal notranslate"><span class="pre">x</span></code> points or the function
evaluated at <code class="docutils literal notranslate"><span class="pre">x</span></code> points for each component.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction.fit_eval">
<span class="sig-name descname"><span class="pre">fit_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbm.spectra.functions.SuperFunction.fit_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the function for a fit.  This differs from the <a class="reference internal" href="#gbm.spectra.functions.SuperFunction.eval" title="gbm.spectra.functions.SuperFunction.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a>
because the <code class="docutils literal notranslate"><span class="pre">params</span></code> vector should only contain the free fit parameters.
The parameters that are set to fixed will automatically be passed to
<a class="reference internal" href="#gbm.spectra.functions.SuperFunction.eval" title="gbm.spectra.functions.SuperFunction.eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> at their fixed value.  This enables a fit to be performed
withfixed parameters and the associated jacobian and covariance matrices
will have the appropriate shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – The parameter vector of the free parameters</p></li>
<li><p><strong>x</strong> (<em>np.array</em>) – The values at which to evaluate the function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>np.array</em> – The function evaluated at the <code class="docutils literal notranslate"><span class="pre">x</span></code> points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbm.spectra.functions.SuperFunction.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate the function over energy to produce a flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – The parameter vector, which can be of length
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nparams</span></code> or equal to the length of the
non-fixed (free) parameters.</p></li>
<li><p><strong>erange</strong> (<em>float</em><em>, </em><em>float</em>) – The energy range over which to integrate</p></li>
<li><p><strong>num_points</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of points used for
integration. Default is 1000.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the integration grid is made in
log-space, False it is linear. Default is True.</p></li>
<li><p><strong>energy</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform integration of E*F(E) to
produce an energy flux, otherwise
integration is over F(E) to produce a
photon flux. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The photon or energy flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction.multiply">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbm.spectra.functions.SuperFunction.multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply two Functions. Can also use the <code class="docutils literal notranslate"><span class="pre">*</span></code> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func1</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function</p></li>
<li><p><strong>func2</strong> (<a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>) – A function to multiply to <code class="docutils literal notranslate"><span class="pre">func1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#gbm.spectra.functions.SuperFunction" title="gbm.spectra.functions.SuperFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperFunction</span></code></a> – A function containing the product of the                 two functions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbm.spectra.functions.SuperFunction.parameter_bounds">
<span class="sig-name descname"><span class="pre">parameter_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apply_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbm.spectra.functions.SuperFunction.parameter_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>The valid parameter bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>apply_state</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will only return the bounds for free parameters.
Default is True.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>[(float, float), …]</em> – The list of bounds [(min, max), …]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<hr class="docutils" />
<div class="section" id="spectral-functions">
<h2>Spectral Functions<a class="headerlink" href="#spectral-functions" title="Permalink to this headline">¶</a></h2>
<p>The functions listed below inherit from <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>
and have the optional metadata described in that class documentation.</p>
<div class="section" id="powerlaw">
<h3>PowerLaw<a class="headerlink" href="#powerlaw" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.PowerLaw">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">PowerLaw</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#PowerLaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.PowerLaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A power law function:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A \bigl(\frac{E}{E_{piv}}\bigr)^{\lambda}\)</span>,</p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> is the power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="comptonized">
<h3>Comptonized<a class="headerlink" href="#comptonized" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.Comptonized">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">Comptonized</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Comptonized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Comptonized" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>An exponentially cut-off power law, parametrized by the
peak of the <span class="math notranslate nohighlight">\(\nu F_{\nu}\)</span> spectrum:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A e^{-(2+\lambda)E/E_{peak}} \bigl(\frac{E}{E_{piv}}\bigr)^\lambda\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{peak}\)</span> is the <span class="math notranslate nohighlight">\(\nu F_{\nu}\)</span> peak in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> is the power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="band">
<h3>Band<a class="headerlink" href="#band" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.Band">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">Band</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#Band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.Band" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>The Band GRB function (a type of smoothly broken power law), parametrized
by the peak of the <span class="math notranslate nohighlight">\(\nu F_{\nu}\)</span> spectrum:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A
\begin{cases}
\bigl(\frac{E}{E_{piv}}\bigr)^\alpha e^{-(2+\alpha)E/E_{peak}},
\text{ if } {E &lt; \frac{(\alpha-\beta)E_{peak}}{2+\alpha}}\\
\bigl(\frac{(\alpha-\beta)E_{peak}}{(2+\alpha)E_{piv}}\bigr)^{\alpha-\beta}
\exp{\beta-\alpha}\bigl(\frac{E}{E_{piv}}\bigr)^\beta, \text{ otherwise }
\end{cases}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{peak}\)</span> is the <span class="math notranslate nohighlight">\(\nu F_{\nu}\)</span> peak in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the low-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the high-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="bandold">
<h3>BandOld<a class="headerlink" href="#bandold" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.BandOld">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">BandOld</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#BandOld"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.BandOld" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>The Band GRB function (a type of smoothly broken power law), using the
original parameterization:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A
\begin{cases}
\bigl(\frac{E}{E_{piv}}\bigr)^\alpha e^{-\frac{E}{E_0}},
\text{ if } {E &lt; (\alpha-\beta) E_0}\\
\bigl(\frac{(\alpha-\beta) E_0}{E_{piv}}\bigr)^{(\alpha-\beta)}
e^{(\beta-\alpha)} \bigl(\frac{E}{E_{piv}}\bigr)^\beta, \text{ otherwise }
\end{cases}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_0\)</span> is the break energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the low-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the high-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
<p class="rubric">References</p>
<p><a class="reference external" href="http://adsabs.harvard.edu/full/1993ApJ...413..281B">Band, D. et al. 1993, ApJ, 413, 281</a></p>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="brokenpowerlaw">
<h3>BrokenPowerLaw<a class="headerlink" href="#brokenpowerlaw" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.BrokenPowerLaw">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">BrokenPowerLaw</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#BrokenPowerLaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.BrokenPowerLaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A sharply-broken power law:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A
\begin{cases}
\bigl(\frac{E}{E_{piv}}\bigr)^\alpha, &amp; \text{ if } {E \leq E_b}\\
\bigl(\frac{E_b}{E_{piv}}\bigr)^\alpha \bigl(\frac{E}{E_b}\bigr)^\beta, &amp;
\text{ otherwise }
\end{cases}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{b}\)</span> is the break energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the low-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the high-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="doublebrokenpowerlaw">
<h3>DoubleBrokenPowerLaw<a class="headerlink" href="#doublebrokenpowerlaw" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.DoubleBrokenPowerLaw">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">DoubleBrokenPowerLaw</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#DoubleBrokenPowerLaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.DoubleBrokenPowerLaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A sharply-broken power law with two breaks:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A
\begin{cases}
\bigl(\frac{E}{E_{piv}}\bigr)^\alpha,
\text{ if } {E \leq E_{b1}}\\
\bigl(\frac{E_{b1}}{E_{piv}}\bigr)^\alpha \bigl(\frac{E}{E_b}\bigr)^\beta,
\text{ if } {E &gt; E_{b1} \text{ and } E \leq E_{b2}}\\
\bigl(\frac{E_{b1}}{E_{piv}}\bigr)^\alpha \bigl(\frac{E_{b1}}{E_{b2}}\bigr)^\beta
\bigl(\frac{E}{E_{b2}}\bigr)^\gamma,
\text{ otherwise}
\end{cases}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{b1}\)</span> is the first break energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{b2}\)</span> is the second break energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the low-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the mid-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span> is the high-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="smoothlybrokenpowerlaw">
<h3>SmoothlyBrokenPowerLaw<a class="headerlink" href="#smoothlybrokenpowerlaw" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.SmoothlyBrokenPowerLaw">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">SmoothlyBrokenPowerLaw</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#SmoothlyBrokenPowerLaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.SmoothlyBrokenPowerLaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A smoothly-broken power law with a break scale:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A \bigl(\frac{E}{E_{piv}}\bigr)^\beta 10^{(\beta-\beta_{piv})}, \\
\text{where }\\
\beta = m \Delta \ln\bigl(\frac{e^\alpha + e^{-\alpha}}{2}\bigr); \text{    }
\beta_{piv} = m \Delta \ln\bigl(\frac{e^{\alpha_{piv}} + e^{-\alpha_{piv}}}{2}\bigr); \\
\alpha = \frac{\log(E/E_b)}{\Delta}; \text{    }
\alpha_{piv} = \frac{\log(E_{piv}/E_b)}{\Delta}; \\
m = \frac{\lambda_2 - \lambda_1}{2}; \text{    }
b = \frac{\lambda_1 + \lambda_2}{2};\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{b}\)</span> is the break energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta\)</span> is the break scale in decades of energy</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1\)</span> is the low-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_2\)</span> is the high-energy power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV.  Nominally fixed to 100 keV.</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="lognormal">
<h3>LogNormal<a class="headerlink" href="#lognormal" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.LogNormal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">LogNormal</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#LogNormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.LogNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Log-Normal function:</p>
<p><span class="math notranslate nohighlight">\(F(E) = \frac{A}{\sqrt{2\pi} \sigma E}
e^{-\bigl(\frac{\ln E - \mu}{2\sigma}\bigr)^2}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu\)</span> is the natural log of energy</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> is the logarithmic standard deviation</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="gaussianlog">
<h3>GaussianLog<a class="headerlink" href="#gaussianlog" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.GaussianLog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">GaussianLog</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#GaussianLog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.GaussianLog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Gaussian with log_10(E):</p>
<p><span class="math notranslate nohighlight">\(F(E) = \frac{A}{\sqrt{2\pi} \sigma}
e^{-\bigl(\frac{\log E-\log E_{cen} }{2\sigma}\bigr)^2}, \\
\text{ where } \\
\sigma = \frac{W}{2.35482}\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the centroid energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the <span class="math notranslate nohighlight">\(\log_{10}\)</span> FWHM at <span class="math notranslate nohighlight">\(E_{cen}\)</span> in decades
of energy</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="gaussianlogvaryingfwhm">
<h3>GaussianLogVaryingFWHM<a class="headerlink" href="#gaussianlogvaryingfwhm" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.GaussianLogVaryingFWHM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">GaussianLogVaryingFWHM</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#GaussianLogVaryingFWHM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.GaussianLogVaryingFWHM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Gaussian with log_10(E) and linearly-varying FWHM:</p>
<p><span class="math notranslate nohighlight">\(F(E) = \frac{A}{\sqrt{2\pi} \sigma}
e^{-\bigl(\frac{\log E-\log E_{cen} }{2\sigma}\bigr)^2}, \\
\text{ where } \\
\sigma = \frac{W + s (\log E - \log E_{cen})}{2.35482}\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the centroid energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the <span class="math notranslate nohighlight">\(\log_{10}\)</span> FWHM at <span class="math notranslate nohighlight">\(E_{cen}\)</span> in decades
of energy</p></li>
<li><p><span class="math notranslate nohighlight">\(s\)</span> is the slope of <span class="math notranslate nohighlight">\(W\)</span> with respect to <span class="math notranslate nohighlight">\(\log_{10}(E)\)</span>
in decades per  <span class="math notranslate nohighlight">\(\log_{10}(E)\)</span></p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="sunyaevtitarchuk">
<h3>SunyaevTitarchuk<a class="headerlink" href="#sunyaevtitarchuk" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.SunyaevTitarchuk">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">SunyaevTitarchuk</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#SunyaevTitarchuk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.SunyaevTitarchuk" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Sunyaev-Titarchuk Comptonization spectra:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A E^2 e^{-E} \int_0^\infty t^{n-1}
e^{-t \bigl(1+\frac{t}{E}\bigr)^{n+3}} \text{d}t, \\
\text{ where } \\
n = -\frac{3}{2} + \sqrt{\gamma + \frac{9}{4}}; \\
\gamma = \frac{511 \pi^2}{G kT \bigl(\tau + \frac{2}{3} \bigr)^2}\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(kT\)</span> is the electron energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> is the optical depth</p></li>
<li><p><span class="math notranslate nohighlight">\(G\)</span> is the geometry factor, fixed at 3 for a spherical cloud and
at 12 for a disk of electrons</p></li>
</ul>
<p class="rubric">References</p>
<p><a class="reference external" href="http://adsabs.harvard.edu/full/1980A%26A....86..121S">Sunyaev, R. A. and Titarchuk, L. G. 1980, A&amp;A, 86, 121</a></p>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="ottb">
<h3>OTTB<a class="headerlink" href="#ottb" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.OTTB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">OTTB</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#OTTB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.OTTB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Optically-Thin Thermal Bremsstrahlung:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A e^{-\frac{E}{kT}} e^{\frac{E_{piv}}{kT}}
\biggl(\frac{E_{piv}}{E} \biggr)\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(kT\)</span> is the electron energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="otts">
<h3>OTTS<a class="headerlink" href="#otts" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.OTTS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">OTTS</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#OTTS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.OTTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Optically-Thin Thermal Synchrotron:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A e^{(E/E_C)^{1/3}}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_C\)</span> is the energy scale in keV</p></li>
</ul>
<p class="rubric">References</p>
<p><a class="reference external" href="http://adsabs.harvard.edu/full/1983ApJ...271..766L">Liang, E. P., et al., 1983, ApJ, 271, 776</a></p>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="blackbody">
<h3>BlackBody<a class="headerlink" href="#blackbody" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.BlackBody">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">BlackBody</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#BlackBody"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.BlackBody" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Black Body spectrum:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A \frac{E^2}{e^{E/kT}-1}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(kT\)</span> is the temperature in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="gaussline">
<h3>GaussLine<a class="headerlink" href="#gaussline" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.GaussLine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">GaussLine</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#GaussLine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.GaussLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Gaussian Line:</p>
<p><span class="math notranslate nohighlight">\(F(E) = A \frac{\text{erfc}(a_l)-\text{erfc}(a_r)}{2(E_r-E_l)}, \\
\text{ where } \\
a_l = \frac{E_l - E_{cen}}{\sqrt{2}\sigma}; \text{    }
a_r = \frac{E_r - E_{cen}}{\sqrt{2}\sigma}; \\
\sigma = W/2.35482\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the centroid energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the FHWM in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="yangsoongpulsar">
<h3>YangSoongPulsar<a class="headerlink" href="#yangsoongpulsar" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.YangSoongPulsar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">YangSoongPulsar</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#YangSoongPulsar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.YangSoongPulsar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Yang Soong’s pulsar spectral form</p>
<p><span class="math notranslate nohighlight">\(F(E) = A C (1 - E_W G), \\
\text{ where} \\
C = \begin{cases}
\bigl(\frac{E}{E_{piv}}\bigr)^{-\alpha}, &amp; \text{ if } {E \leq E_b} \\
\frac{M}{E} e^{-E/E_{piv}}, &amp; \text{ otherwise }
\end{cases}; \\
M = e^{E_b/E_F} E_b \bigl(\frac{E_b}{E_{piv}}\bigr)^{-\alpha}; \\
G = \frac{0.94}{W} e^{-2.76 (\frac{E-E_{cen}}{W})^2};\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_b\)</span> is the break energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_F\)</span> is the e-folding energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_W\)</span> is the equivalent line width in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the line centroid in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the FWHM of the line, in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV</p></li>
</ul>
<p class="rubric">References</p>
<p><a class="reference external" href="http://adsabs.harvard.edu/full/1990ApJ...348..641S">Soong, Y., et al. 1990, ApJ, 348, 641</a></p>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="tanakapulsar">
<h3>TanakaPulsar<a class="headerlink" href="#tanakapulsar" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.TanakaPulsar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">TanakaPulsar</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#TanakaPulsar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.TanakaPulsar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>Tanaka’s pulsar model</p>
<p><span class="math notranslate nohighlight">\(F(E) = A \frac{C}{C_{piv}} e^{L_{piv}-L}, \\
\text{ where} \\
C = A E^{-\alpha} e^{-E/kT}; \text{    }
C_{piv} E_{piv}^{-\alpha} e^{-E_{piv}/kT}; \\
L = \sum_{i=1}^{N_L} \frac{\tau_i (i W)^2 [E/(i E_L)]^2}{(E-i E_L)^2 + (i W)^2}; \\
L_{piv} = \sum_{i=1}^{N_L} \frac{\tau_i (i W)^2 [E_{piv}/(i E_L)]^2}
{(E_{piv}-i E_L)^2 + (i W)^2}; \\\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude in ph/s/cm^2/keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the power-law index</p></li>
<li><p><span class="math notranslate nohighlight">\(kT\)</span> is the temperature in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau_1\)</span> is the optical depth of the first line</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau_2\)</span> is the optical depth of the second line</p></li>
<li><p><span class="math notranslate nohighlight">\(N_L\)</span> is the number of lines; fixed at either 0, 1, or 2</p></li>
<li><p><span class="math notranslate nohighlight">\(E_L\)</span> is the line centroid in keV of the first line</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the line FWHM in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV</p></li>
</ul>
<p class="rubric">References</p>
<p><a class="reference external" href="https://apps.dtic.mil/docs/citations/ADA461878">Grove, J. E., et al. 1995, ApJ, 438, L25</a></p>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="lowenergycutoff">
<h3>LowEnergyCutoff<a class="headerlink" href="#lowenergycutoff" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.LowEnergyCutoff">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">LowEnergyCutoff</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#LowEnergyCutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.LowEnergyCutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Low-Energy cutoff (Multiplicative Component):</p>
<p><span class="math notranslate nohighlight">\(F(E) = \begin{cases}
(E/E_{cut})^{E_{cut}/E_F} e^{(E_{cut}-E)/E_F} &amp; \text{ if } {E \leq E_{cut}} \\
1 &amp; \text{ otherwise }
\end{cases}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{cut}\)</span> is the cutoff energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the folding energy in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="highenergycutoff">
<h3>HighEnergyCutoff<a class="headerlink" href="#highenergycutoff" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.HighEnergyCutoff">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">HighEnergyCutoff</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#HighEnergyCutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.HighEnergyCutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A High-Energy cutoff (Multiplicative Component):</p>
<p><span class="math notranslate nohighlight">\(F(E) = \begin{cases}
(E/E_{cut})^{E_{cut}/E_F} e^{(E_{cut}-E)/E_F} &amp; \text{ if } {E &gt; E_{cut}} \\
1 &amp; \text{ otherwise }
\end{cases}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{cut}\)</span> is the cutoff energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the folding energy in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="powerlawmult">
<h3>PowerLawMult<a class="headerlink" href="#powerlawmult" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.PowerLawMult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">PowerLawMult</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#PowerLawMult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.PowerLawMult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Power Law (Multiplicative Component):</p>
<p><span class="math notranslate nohighlight">\(F(E) = \bigl(\frac{E}{E_{piv}} \bigr)^\lambda\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> is the index</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{piv}\)</span> is the pivot energy in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="gausslinemult">
<h3>GaussLineMult<a class="headerlink" href="#gausslinemult" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.GaussLineMult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">GaussLineMult</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#GaussLineMult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.GaussLineMult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Gaussian Line (Multiplicative Component):</p>
<p><span class="math notranslate nohighlight">\(F(E) = e^{I G}, \\
\text{ where } \\
G = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(E-E_{cen})^2}{2\sigma^2}}; \\
\sigma = W/2.35482\)</span></p>
<p>and where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I\)</span> is the intensity</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the centroid energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the FWHM in keV</p></li>
</ul>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="lorentzlinemult">
<h3>LorentzLineMult<a class="headerlink" href="#lorentzlinemult" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="gbm.spectra.functions.LorentzLineMult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbm.spectra.functions.</span></span><span class="sig-name descname"><span class="pre">LorentzLineMult</span></span><a class="reference internal" href="../_modules/gbm/spectra/functions.html#LorentzLineMult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gbm.spectra.functions.LorentzLineMult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gbm.spectra.functions.Function" title="gbm.spectra.functions.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">gbm.spectra.functions.Function</span></code></a></p>
<p>A Lorentzian Line (Multiplicative Component):</p>
<p><span class="math notranslate nohighlight">\(F(E) = e^{\frac{I}{W^2 + (E-E_{cen})^2}}\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I\)</span> is the intensity</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{cen}\)</span> is the centroid energy in keV</p></li>
<li><p><span class="math notranslate nohighlight">\(W\)</span> is the FWHM in keV</p></li>
</ul>
</dd></dl>

<hr class="docutils" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api-sims.html" class="btn btn-neutral float-right" title="Simulate Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api-background.html" class="btn btn-neutral float-left" title="Background Estimation Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright .

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>