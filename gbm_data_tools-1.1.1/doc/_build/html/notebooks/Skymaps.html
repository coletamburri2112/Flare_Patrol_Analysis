

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>GBM Localizations and Sky Maps &mdash; GBM Data Tools 1.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
        <script defer="defer" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Finding GBM Data" href="DataFinders.html" />
    <link rel="prev" title="Quicklook Trigger Data" href="Trigdat.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GBM Data Tools
          

          
            
            <img src="../_static/fermi_face.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Jupyter Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="PhaiiData.html">GBM Science Data: Time History Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="TteData.html">TTE Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Responses.html">Detector Response Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="PositionHistory.html">The Position History Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Trigdat.html">Quicklook Trigger Data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GBM Localizations and Sky Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataFinders.html">Finding GBM Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="PhaExport.html">Analysis Workflow: Reduction and Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="SpectralFitting.html">Analysis Workflow: Spectral Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ScatFiles.html">GBM Spectral Catalog Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Simulations.html">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataPrimitives.html">Introduction to the Data Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plugins.html">Plugin-like Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="Visualizations.html">Visualizations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">GBM Data Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Change Logs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GBM Data Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Jupyter Notebooks</a> &raquo;</li>
        
      <li>GBM Localizations and Sky Maps</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/Skymaps.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="GBM-Localizations-and-Sky-Maps">
<h1>GBM Localizations and Sky Maps<a class="headerlink" href="#GBM-Localizations-and-Sky-Maps" title="Permalink to this headline">¶</a></h1>
<p>As part of mission operations, GBM produces localizations for GRBs and disseminates these to the community. GCN notices are sent to interested follow-up observers containing brief summary information, and HEALPix FITS files containing the localization are created and hosted at the Fermi Science Support Center. These localizations contain the best-modeled systematic uncertainty in the localization and contain a host of metadata such as the individual detector pointings and the geocenter location
as observed by Fermi.</p>
<p>You can read one of these HEALPix files using the <code class="docutils literal notranslate"><span class="pre">GbmHealPix</span></code> class:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm</span> <span class="kn">import</span> <span class="n">test_data_dir</span>
<span class="kn">from</span> <span class="nn">gbm.data</span> <span class="kn">import</span> <span class="n">GbmHealPix</span>

<span class="c1"># open a GBM localization</span>
<span class="n">loc</span> <span class="o">=</span> <span class="n">GbmHealPix</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">test_data_dir</span><span class="o">+</span><span class="s1">&#39;/glg_healpix_all_bn190915240_v00.fit&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
glg_healpix_all_bn190915240_v00.fit
</pre></div></div>
</div>
<p>You can easily access the HEALPix-specific info:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Healpix nside: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">nside</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Healpix npix: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">npix</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel area (sq. deg.): </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">pixel_area</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Healpix nside: 128
Healpix npix: 196608
Pixel area (sq. deg.): 0.20982341130279172
</pre></div></div>
</div>
<p>As for the localization information, you can retrieve the sky position with the highest probability (centroid):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loc</span><span class="o">.</span><span class="n">centroid</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(48.8671875, 4.181528273111476)
</pre></div></div>
</div>
<p>Or you can determine the probability of the localization at a particular point in the sky:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loc</span><span class="o">.</span><span class="n">probability</span><span class="p">(</span><span class="mf">49.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.009200395297273567
</pre></div></div>
</div>
<p>And if you want to determine the confidence level a particular point on the sky is relative to the localization:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loc</span><span class="o">.</span><span class="n">confidence</span><span class="p">(</span><span class="mf">40.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.865783539232832
</pre></div></div>
</div>
<p>Often for follow-up observations, it’s useful to know how much sky area the localization covers at a some confidence level:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loc</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span> <span class="c1"># 90% confidence in units of sq. degrees</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
281.1633711457409
</pre></div></div>
</div>
<p>And for plotting or other purposes, you can retrieve the RA and Dec “paths” for a given confidence region.</p>
<p><strong>Note:</strong> <em>A confidence region may have many disjoint pieces, so this will be a list of arrays</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> agg
<span class="n">loc</span><span class="o">.</span><span class="n">confidence_region_path</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([[ 4.61281337e+01,  2.59721728e-01],
        [ 4.53138456e+01,  5.02793296e-01],
        [ 4.51253482e+01,  6.21222158e-01],
        [ 4.43160681e+01,  1.50837989e+00],
        [ 4.41225627e+01,  2.36616357e+00],
        [ 4.40920226e+01,  2.51396648e+00],
        [ 4.38604592e+01,  3.51955307e+00],
        [ 4.38130019e+01,  4.52513966e+00],
        [ 4.41225627e+01,  5.23313031e+00],
        [ 4.43770701e+01,  5.53072626e+00],
        [ 4.50410901e+01,  6.53631285e+00],
        [ 4.51253482e+01,  6.62602576e+00],
        [ 4.61281337e+01,  7.28272773e+00],
        [ 4.66920493e+01,  7.54189944e+00],
        [ 4.71309192e+01,  7.65985811e+00],
        [ 4.81337047e+01,  7.71980664e+00],
        [ 4.91364903e+01,  8.00964739e+00],
        [ 5.01392758e+01,  8.17249985e+00],
        [ 5.11420613e+01,  7.90708927e+00],
        [ 5.21448468e+01,  7.74393795e+00],
        [ 5.25325056e+01,  7.54189944e+00],
        [ 5.31476323e+01,  7.20106267e+00],
        [ 5.41504178e+01,  6.99819453e+00],
        [ 5.47633728e+01,  6.53631285e+00],
        [ 5.51532033e+01,  6.06643188e+00],
        [ 5.55700960e+01,  5.53072626e+00],
        [ 5.59253530e+01,  4.52513966e+00],
        [ 5.61559889e+01,  3.88048183e+00],
        [ 5.62452032e+01,  3.51955307e+00],
        [ 5.61559889e+01,  3.35981053e+00],
        [ 5.52575186e+01,  2.51396648e+00],
        [ 5.51532033e+01,  2.39467763e+00],
        [ 5.41504178e+01,  1.61425423e+00],
        [ 5.38532764e+01,  1.50837989e+00],
        [ 5.31476323e+01,  1.16845749e+00],
        [ 5.21448468e+01,  7.09923588e-01],
        [ 5.16444830e+01,  5.02793296e-01],
        [ 5.11420613e+01,  3.16344923e-01],
        [ 5.01392758e+01,  1.89394367e-01],
        [ 4.91364903e+01,  1.24551411e-01],
        [ 4.81337047e+01, -2.69349612e-02],
        [ 4.71309192e+01,  7.52677558e-02],
        [ 4.61281337e+01,  2.59721728e-01]])]
</pre></div></div>
</div>
<p>You can even determine the probability that a point source at a given location is association with the skymap (as opposed to the null hypothesis of two spatially-unrelated sources):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># find the probability that a point source on the sky is associated with our skymap</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">source_probability</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">source_probability</span><span class="p">(</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9873891225982346
4.406012354285324e-15
</pre></div></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">GbmHealPix.region_probability()</span></code> function with another HEALPix object to return the probability that the two maps are spatially associated.</p>
<p>You can retrieve, as attributes, various other interesting tidbits:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Info of other relevant things...</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sun location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">sun_location</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Geocenter location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">geo_location</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Geocenter radius: </span><span class="si">{}</span><span class="s1"> deg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">geo_radius</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Detector n0 pointing: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">n0_pointing</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fraction of localization on Earth </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">geo_probability</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sun location: (172.5011935415178, 3.23797213866954)
Geocenter location: (319.8312390218318, 17.40612934717674)
Geocenter radius: 67.2950460311874 deg
Detector n0 pointing: (146.5959532829778, 36.96759511828569)
Fraction of localization on Earth 8.442885759828031e-06
</pre></div></div>
</div>
<p>Of course, if you have a HEALPix file, you’ll want to make a pretty sky map!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">gbm.plot</span> <span class="kn">import</span> <span class="n">SkyPlot</span>

<span class="c1"># initialize</span>
<span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>

<span class="c1"># add our HEALPix object</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_19_0.png" src="../_images/notebooks_Skymaps_19_0.png" />
</div>
</div>
<p>w00t! This is for default plotting options, but you can do a lot of customization on what is plotted (more on that in <a class="reference internal" href="Visualizations.html"><span class="doc">Visualizations</span></a>). What if we want filled contours instead of a gradient, no Galactic Plane, and only some of the detectors? Also, by default we’re plotting the 1-, 2-, and 3-sigma contours, so we could plot the 50% and 90% instead:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clevels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="n">galactic_plane</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n7&#39;</span><span class="p">,</span> <span class="s1">&#39;n8&#39;</span><span class="p">,</span> <span class="s1">&#39;nb&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_21_0.png" src="../_images/notebooks_Skymaps_21_0.png" />
</div>
</div>
<p>Sometimes localizations will have probability that overlaps the Earth. For primarily historical and logistical reasons, the GBM HEALPix maps don’t remove any probability that falls on the Earth, but you can do that using the <code class="docutils literal notranslate"><span class="pre">GbmHealPix.remove_earth()</span></code> function, which will return you a new <code class="docutils literal notranslate"><span class="pre">GbmHealPix</span></code> object with the probability on the Earth removed.</p>
<p>In addition to reading existing GBM HEALPix maps, you can create your own! In fact, you can build more generic maps using the <code class="docutils literal notranslate"><span class="pre">HealPix</span></code> class. For example, let’s create a 10-degree radius Gaussian centered at RA, Dec = 180.0, 0.0:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.data</span> <span class="kn">import</span> <span class="n">HealPix</span>

<span class="c1"># 10 degree gaussian centered at RA,Dec = 180.0, 0.0</span>
<span class="n">gauss_map</span> <span class="o">=</span> <span class="n">HealPix</span><span class="o">.</span><span class="n">from_gaussian</span><span class="p">(</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

<span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>
<span class="c1"># set to False and empy because we have no info to plot</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">gauss_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_23_0.png" src="../_images/notebooks_Skymaps_23_0.png" />
</div>
</div>
<p>Or a 3-degree-width annulus on the sky centered at RA, Dec = 300.0, -30.0, with radius of 80 degrees:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">annulus_map</span> <span class="o">=</span> <span class="n">HealPix</span><span class="o">.</span><span class="n">from_annulus</span><span class="p">(</span><span class="mf">300.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>

<span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">annulus_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_25_0.png" src="../_images/notebooks_Skymaps_25_0.png" />
</div>
</div>
<p>Or what if you only have a list of coordinates and you want to plot an equal-probability region on the sky:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ra_pts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">270.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">]</span>
<span class="n">dec_pts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]</span>

<span class="n">verts_map</span> <span class="o">=</span> <span class="n">HealPix</span><span class="o">.</span><span class="n">from_vertices</span><span class="p">(</span><span class="n">ra_pts</span><span class="p">,</span> <span class="n">dec_pts</span><span class="p">,</span> <span class="n">nside</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">verts_map</span><span class="p">,</span> <span class="n">earth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sun</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">detectors</span><span class="o">=</span><span class="p">[],</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">clevels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.999</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_27_0.png" src="../_images/notebooks_Skymaps_27_0.png" />
</div>
</div>
<p>You can even convolve your map with a Gaussian or a model that is built out of Gaussians:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">deg2rad</span>

<span class="c1"># a single Gaussian of sigma_deg radius</span>
<span class="k">def</span> <span class="nf">gauss_model</span><span class="p">(</span><span class="n">sigma_deg</span><span class="p">):</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">deg2rad</span><span class="p">(</span><span class="n">sigma_deg</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">([</span><span class="n">sigma</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">])</span>

<span class="c1"># convolved with a 5-deg radius Gaussian</span>
<span class="n">verts_convolved</span> <span class="o">=</span> <span class="n">verts_map</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">gauss_model</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>

<span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">verts_convolved</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_29_0.png" src="../_images/notebooks_Skymaps_29_0.png" />
</div>
</div>
<p>And finally, you can multiply maps together to produce a combined sky map:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># multiply the Gaussian map with the annulus map</span>
<span class="n">multiplied</span> <span class="o">=</span> <span class="n">HealPix</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">gauss_map</span><span class="p">,</span> <span class="n">annulus_map</span><span class="p">)</span>

<span class="n">skyplot</span> <span class="o">=</span> <span class="n">SkyPlot</span><span class="p">()</span>
<span class="n">skyplot</span><span class="o">.</span><span class="n">add_healpix</span><span class="p">(</span><span class="n">multiplied</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Skymaps_31_0.png" src="../_images/notebooks_Skymaps_31_0.png" />
</div>
</div>
<p>Ok, enough about sky maps for now, continue to find out about <a class="reference internal" href="DataFinders.html"><span class="doc">how to find and retrieve the GBM data you’re looking for.</span></a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="DataFinders.html" class="btn btn-neutral float-right" title="Finding GBM Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Trigdat.html" class="btn btn-neutral float-left" title="Quicklook Trigger Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright .

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>