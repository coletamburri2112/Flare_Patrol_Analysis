

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Introduction to the Data Primitives &mdash; GBM Data Tools 1.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
        <script defer="defer" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plugin-like Architecture" href="Plugins.html" />
    <link rel="prev" title="Simulations" href="Simulations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GBM Data Tools
          

          
            
            <img src="../_static/fermi_face.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Jupyter Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="PhaiiData.html">GBM Science Data: Time History Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="TteData.html">TTE Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Responses.html">Detector Response Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="PositionHistory.html">The Position History Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Trigdat.html">Quicklook Trigger Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Skymaps.html">GBM Localizations and Sky Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataFinders.html">Finding GBM Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="PhaExport.html">Analysis Workflow: Reduction and Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="SpectralFitting.html">Analysis Workflow: Spectral Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ScatFiles.html">GBM Spectral Catalog Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Simulations.html">Simulations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction to the Data Primitives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#TimeBins-and-EnergyBins">TimeBins and EnergyBins</a></li>
<li class="toctree-l3"><a class="reference internal" href="#TimeEnergyBins">TimeEnergyBins</a></li>
<li class="toctree-l3"><a class="reference internal" href="#EventList">EventList</a></li>
<li class="toctree-l3"><a class="reference internal" href="#TimeRange-and-GTI">TimeRange and GTI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Plugins.html">Plugin-like Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="Visualizations.html">Visualizations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">GBM Data Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Change Logs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GBM Data Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Jupyter Notebooks</a> &raquo;</li>
        
      <li>Introduction to the Data Primitives</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/DataPrimitives.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Introduction-to-the-Data-Primitives">
<h1>Introduction to the Data Primitives<a class="headerlink" href="#Introduction-to-the-Data-Primitives" title="Permalink to this headline">¶</a></h1>
<p>Within the GBM Data Tools, there are data primitive classes that handle the properties and manipulation of the fundamental types of data that GBM produces. Often you won’t need to directly worry about these classes and how they work if you are doing sufficiently high-level work using the rest of the data tools (e.g. plotting lightcurves/spectra, standard data binning, background/spectral fitting, etc.), however the API exposes a full array of properties and methods that allow you to work
directly with the data primitives.</p>
<p>In general, there are three primary primitive types that describe GBM Data: <code class="docutils literal notranslate"><span class="pre">Bins</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeEnergyBins</span></code>, and <code class="docutils literal notranslate"><span class="pre">EventList</span></code>. Specifically, <code class="docutils literal notranslate"><span class="pre">Bins</span></code> refers to 1D binned data (histograms), and there are two derived types with special additional properties: <code class="docutils literal notranslate"><span class="pre">TimeBins</span></code> and <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code>. While <code class="docutils literal notranslate"><span class="pre">TimeEnergyBins</span></code> is a class representing 2D binned data, where one axis is time and the other is energy. The final of these primitive types, <code class="docutils literal notranslate"><span class="pre">EventList</span></code>, is a class representing a list of events, where
each event has some attributes, namely time and energy channel.</p>
<p>In addition to these primary primitives, there are two more additional “utility” primitives called <code class="docutils literal notranslate"><span class="pre">TimeRange</span></code> and <code class="docutils literal notranslate"><span class="pre">GTI</span></code> which represent a single span of time, and a series of disjoint spans of time, respectively.</p>
<hr class="docutils" />
<div class="section" id="TimeBins-and-EnergyBins">
<h2>TimeBins and EnergyBins<a class="headerlink" href="#TimeBins-and-EnergyBins" title="Permalink to this headline">¶</a></h2>
<p>These classes are 1D histograms with special properties. Both can be instantiated with an array of <code class="docutils literal notranslate"><span class="pre">counts</span></code> (number of things in each bin), <code class="docutils literal notranslate"><span class="pre">lo_edges</span></code> and <code class="docutils literal notranslate"><span class="pre">hi_edges</span></code> (the edge boundaries for each bin), and <code class="docutils literal notranslate"><span class="pre">exposure</span></code> (the exposure in each bin).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">gbm.data.primitives</span> <span class="kn">import</span> <span class="n">TimeBins</span><span class="p">,</span> <span class="n">EnergyBins</span>

<span class="c1"># create a TimeBins object: 4 time bins, with exposure &lt; binwidth due to some deadtime</span>
<span class="n">time_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">time_lo_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>
<span class="n">time_hi_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="n">time_exposure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">])</span>
<span class="n">timebins</span> <span class="o">=</span> <span class="n">TimeBins</span><span class="p">(</span><span class="n">time_counts</span><span class="p">,</span> <span class="n">time_lo_edges</span><span class="p">,</span> <span class="n">time_hi_edges</span><span class="p">,</span> <span class="n">time_exposure</span><span class="p">)</span>

<span class="c1"># create an EnergyBins object: 4 energy bins, with the same exposure for each bin</span>
<span class="n">energy_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">energy_lo_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">])</span>
<span class="n">energy_hi_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">35.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">])</span>
<span class="n">energy_exposure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.67</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="n">energybins</span> <span class="o">=</span> <span class="n">EnergyBins</span><span class="p">(</span><span class="n">energy_counts</span><span class="p">,</span> <span class="n">energy_lo_edges</span><span class="p">,</span> <span class="n">energy_hi_edges</span><span class="p">,</span> <span class="n">energy_exposure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There are a variety of properties that can be retrieved from the objects once they’ve been created. For example, maybe you want to know what the rate (and rate uncertainty) is for each of your bins:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">timebins</span><span class="o">.</span><span class="n">rates</span><span class="p">,</span> \
<span class="n">timebins</span><span class="o">.</span><span class="n">rate_uncertainty</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([1.01010101, 3.06122449, 5.15463918, 2.08333333]),
 array([1.01010101, 1.76739878, 2.30522472, 1.47313913]))
</pre></div></div>
</div>
<p>Or maybe you need the bin centers and full domain of the data because you want to make a plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">timebins</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> \
<span class="n">timebins</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([1.5, 2.5, 3.5, 4.5]), (1.0, 5.0))
</pre></div></div>
</div>
<p>Similarly, you can retrieve the same properties for <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code>, with some important differences. <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code> is defined to account for a spectrum that spans orders of magnitude, therefore the bin centroids are calculated as the geometric mean, instead of the arithmetic mean. Also, the rate is naturally defined as the differential rate (i.e. divided by the bin width).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energybins</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> \
 <span class="n">energybins</span><span class="o">.</span><span class="n">rates</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 18.70828693,  59.16079783, 158.11388301, 387.29833462]),
 array([0.0041365 , 0.00477289, 0.00344709, 0.00059093]))
</pre></div></div>
</div>
<p>In addition to these properties (and more), these classes have some important methods. You can add multiple <code class="docutils literal notranslate"><span class="pre">TimeBins</span></code> or <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code> together to create a new class that is the sum (provided they cover the same time and energy range).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">timebins2</span> <span class="o">=</span> <span class="n">TimeBins</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">timebins</span><span class="p">,</span> <span class="n">timebins</span><span class="p">])</span>
<span class="n">timebins</span><span class="o">.</span><span class="n">counts</span><span class="p">,</span> \
<span class="n">timebins2</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([1, 3, 5, 2]), array([ 2.,  6., 10.,  4.]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energybins2</span> <span class="o">=</span> <span class="n">EnergyBins</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">energybins</span><span class="p">,</span> <span class="n">energybins</span><span class="p">])</span>
<span class="n">energybins</span><span class="o">.</span><span class="n">counts</span><span class="p">,</span> \
<span class="n">energybins2</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([1, 3, 5, 2]), array([ 2.,  6., 10.,  4.]))
</pre></div></div>
</div>
<p>You can merge multiple <code class="docutils literal notranslate"><span class="pre">TimeBins</span></code> or <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code> together into one (even if they are overlapping)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_timebins</span> <span class="o">=</span> <span class="n">TimeBins</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">]))</span>
<span class="n">merged_timebins</span> <span class="o">=</span> <span class="n">TimeBins</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">timebins</span><span class="p">,</span> <span class="n">new_timebins</span><span class="p">])</span>
<span class="n">merged_timebins</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> \
<span class="n">merged_timebins</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 1.5,  2.5,  3.5,  4.5,  8.5,  9.5, 10.5]),
 array([ 1.,  3.,  5.,  2., 10., 20.,  3.]))
</pre></div></div>
</div>
<p>And because data can have gaps in it (and that can complicate analysis if not properly handled), these classes have the ability to split into a list of contiguous bins:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">split_timebins</span> <span class="o">=</span> <span class="n">merged_timebins</span><span class="o">.</span><span class="n">contiguous_bins</span><span class="p">()</span>
<span class="p">[(</span><span class="n">tb</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> <span class="n">tb</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">tb</span> <span class="ow">in</span> <span class="n">split_timebins</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(array([1.5, 2.5, 3.5, 4.5]), array([1., 3., 5., 2.])),
 (array([ 8.5,  9.5, 10.5]), array([10., 20.,  3.]))]
</pre></div></div>
</div>
<p>Maybe we don’t want all of our data for an analysis, but only a snippet. We can make a slice:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># slice energy bins so that we only have data in the 50-200 keV range, inclusive</span>
<span class="n">slice_energybins</span> <span class="o">=</span> <span class="n">energybins</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">)</span>
<span class="n">slice_energybins</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(35.0, 250.0)
</pre></div></div>
</div>
<p>And finally we can rebin the data if we want, using some type of binning algorithm:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.binning.binned</span> <span class="kn">import</span> <span class="n">combine_by_factor</span>
<span class="n">rebinned_energybins</span> <span class="o">=</span> <span class="n">energybins</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">combine_by_factor</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># rebin by a factor of 2</span>
<span class="n">rebinned_energybins</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> \
<span class="n">rebinned_energybins</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 31.6227766 , 244.94897428]), array([4, 7]))
</pre></div></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="TimeEnergyBins">
<h2>TimeEnergyBins<a class="headerlink" href="#TimeEnergyBins" title="Permalink to this headline">¶</a></h2>
<p>This class is a 2D representation of data that have 2 axes: time and energy. To successfully create such an object, you need to provide a 2D <code class="docutils literal notranslate"><span class="pre">counts</span></code> array (the number of counts in each time bin for each energy channel), <code class="docutils literal notranslate"><span class="pre">tstart</span></code> and <code class="docutils literal notranslate"><span class="pre">tstop</span></code>, the edges for the time bins, <code class="docutils literal notranslate"><span class="pre">exposure</span></code> the time exposure in each bin, and <code class="docutils literal notranslate"><span class="pre">emin</span></code> and <code class="docutils literal notranslate"><span class="pre">emax</span></code>, the edges for the energy bins. In general, many of the same properties and methods for <code class="docutils literal notranslate"><span class="pre">TimeBins</span></code> and <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code> are available here, keeping in
mind that there are different methods for each axis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.data.primitives</span> <span class="kn">import</span> <span class="n">TimeEnergyBins</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span> <span class="c1"># 4 time bins, 2 energy channels</span>
<span class="n">tstart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>
<span class="n">tstop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="n">exposure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">])</span>
<span class="n">emin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">35.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">])</span>
<span class="n">emax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">350.0</span><span class="p">])</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">TimeEnergyBins</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">tstart</span><span class="p">,</span> <span class="n">tstop</span><span class="p">,</span> <span class="n">exposure</span><span class="p">,</span> <span class="n">emin</span><span class="p">,</span> <span class="n">emax</span><span class="p">)</span>

<span class="c1"># how many times, how many channels</span>
<span class="n">bins</span><span class="o">.</span><span class="n">numtimes</span><span class="p">,</span> \
<span class="n">bins</span><span class="o">.</span><span class="n">numchans</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 2)
</pre></div></div>
</div>
<p>Similar to the 1D counterparts, we can access various properties like the bin centroids:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bins</span><span class="o">.</span><span class="n">time_centroids</span><span class="p">,</span> \
<span class="n">bins</span><span class="o">.</span><span class="n">energy_centroids</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([1.5, 2.5, 3.5, 4.5]), array([ 72.45688373, 229.12878475]))
</pre></div></div>
</div>
<p>Or the bin widths:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bins</span><span class="o">.</span><span class="n">time_widths</span><span class="p">,</span> \
<span class="n">bins</span><span class="o">.</span><span class="n">chan_widths</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([1., 1., 1., 1.]), array([115., 200.]))
</pre></div></div>
</div>
<p>And we can immediately return the rates and uncertainty for each bin:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="o">.</span><span class="n">rates</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="o">.</span><span class="n">rate_uncertainty</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 1.01010101 10.1010101 ]
 [ 3.06122449 20.40816327]
 [ 5.15463918  3.09278351]
 [ 2.08333333  7.29166667]]
[[1.01010101 3.19421986]
 [1.76739878 4.56340404]
 [2.30522472 1.78561939]
 [1.47313913 2.75599095]]
</pre></div></div>
</div>
<p>As for the available methods, you can perform all of following operations similar to the 1D counterparts: * Retrieve a list of contiguous bins (<code class="docutils literal notranslate"><span class="pre">contiguous_time_bins()</span></code> and <code class="docutils literal notranslate"><span class="pre">contiguous_energy_bins()</span></code>) * Perform a slice (<code class="docutils literal notranslate"><span class="pre">slice_time()</span></code> and <code class="docutils literal notranslate"><span class="pre">slice_energy()</span></code>) * Rebin (<code class="docutils literal notranslate"><span class="pre">rebin_time()</span></code> and <code class="docutils literal notranslate"><span class="pre">rebin_energy()</span></code>) * Merge multiple <code class="docutils literal notranslate"><span class="pre">TimeEnergyBins</span></code> across one axis (<code class="docutils literal notranslate"><span class="pre">merge_time()</span></code> and <code class="docutils literal notranslate"><span class="pre">merge_energy()</span></code>)</p>
<p>In addition to these methods, you can also integrate along one axis of <code class="docutils literal notranslate"><span class="pre">TimeEnergyBins</span></code> to return the corresponding <code class="docutils literal notranslate"><span class="pre">TimeBins</span></code> or <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over energy</span>
<span class="n">energy_integrated</span> <span class="o">=</span> <span class="n">bins</span><span class="o">.</span><span class="n">integrate_energy</span><span class="p">()</span>
<span class="nb">type</span><span class="p">(</span><span class="n">energy_integrated</span><span class="p">),</span> \
<span class="n">energy_integrated</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(gbm.data.primitives.TimeBins, array([11, 23,  8,  9]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over time</span>
<span class="n">time_integrated</span> <span class="o">=</span> <span class="n">bins</span><span class="o">.</span><span class="n">integrate_time</span><span class="p">()</span>
<span class="nb">type</span><span class="p">(</span><span class="n">time_integrated</span><span class="p">),</span> \
<span class="n">time_integrated</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(gbm.data.primitives.EnergyBins, array([11, 40]))
</pre></div></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="EventList">
<h2>EventList<a class="headerlink" href="#EventList" title="Permalink to this headline">¶</a></h2>
<p>Unlike the previous primitives, <code class="docutils literal notranslate"><span class="pre">EventList</span></code> is design to work with <em>semi-unbinned</em> data. Generally <code class="docutils literal notranslate"><span class="pre">EventList</span></code> is a list of events with attributes; specifically, it is a list of event arrival times with a PHA channel attribute. The <em>semi-unbinned</em> qualification comes from the fact that the time axis of the data is not binned (down to the precision of the instrument being able to measure the individual arrival times of photons), but the energy axis <em>is necessarily</em> binned into energy
channels. For this reason, <code class="docutils literal notranslate"><span class="pre">EventList</span></code> not only contains a list of times, but has some metadata that translates the PHA channel attribute to an energy calibration.</p>
<p>Because of the metadata requirement, there are a couple of ways to create an <code class="docutils literal notranslate"><span class="pre">EventList</span></code> object. One can instantiate with the relevant arrays in numpy.recarray or astropy.io.fits.fitsrec.FITS_rec format (e.g. from reading one of the GBM TTE data files). Or maybe we want to <em>create</em> an EventList from a simulation. Then we would use <code class="docutils literal notranslate"><span class="pre">EventList.from_lists()</span></code> which requires a list of arrival times, a list of PHA channels, and lists of the lower and upper edges of the energy channel calibration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.data.primitives</span> <span class="kn">import</span> <span class="n">EventList</span>
<span class="c1"># 7 events</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">4.9</span><span class="p">,</span> <span class="mf">8.8</span><span class="p">,</span> <span class="mf">8.7</span><span class="p">]</span>
<span class="n">phas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># 4 channels</span>
<span class="n">emin</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">]</span>
<span class="n">emax</span> <span class="o">=</span> <span class="p">[</span><span class="mf">35.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">]</span>

<span class="n">eventlist</span> <span class="o">=</span> <span class="n">EventList</span><span class="o">.</span><span class="n">from_lists</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">phas</span><span class="p">,</span> <span class="n">emin</span><span class="p">,</span> <span class="n">emax</span><span class="p">)</span>
<span class="n">eventlist</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> \
<span class="n">eventlist</span><span class="o">.</span><span class="n">time_range</span><span class="p">,</span> \
<span class="n">eventlist</span><span class="o">.</span><span class="n">energy_range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(7, (1.0, 8.8), (10.0, 600.0))
</pre></div></div>
</div>
<p>One of the nice properties of <code class="docutils literal notranslate"><span class="pre">EventList</span></code> is that you can immediately retrieve the count spectrum as an <code class="docutils literal notranslate"><span class="pre">EnergyBins</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">eventlist</span><span class="o">.</span><span class="n">count_spectrum</span>
<span class="nb">type</span><span class="p">(</span><span class="n">spectrum</span><span class="p">),</span> \
<span class="n">spectrum</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(gbm.data.primitives.EnergyBins, array([2, 2, 1, 2]))
</pre></div></div>
</div>
<p>As with the binned datatypes, you can slice in time and energy, which returns a new <code class="docutils literal notranslate"><span class="pre">EventList</span></code> containing the slice:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time_sliced</span> <span class="o">=</span> <span class="n">eventlist</span><span class="o">.</span><span class="n">time_slice</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span> <span class="c1"># return events with 2-5 s</span>
<span class="n">chan_sliced</span> <span class="o">=</span> <span class="n">eventlist</span><span class="o">.</span><span class="n">channel_slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># return events in channels 1 &amp; 2</span>
<span class="n">energy_sliced</span> <span class="o">=</span> <span class="n">eventlist</span><span class="o">.</span><span class="n">energy_slice</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span> <span class="c1"># return events in energy channels spanning 10-100 keV</span>

<span class="n">time_sliced</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> \
<span class="n">chan_sliced</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> \
<span class="n">energy_sliced</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 3, 4)
</pre></div></div>
</div>
<p>As with <code class="docutils literal notranslate"><span class="pre">TimeEnergyBins</span></code>, you can rebin the <code class="docutils literal notranslate"><span class="pre">EventList</span></code> in energy using <code class="docutils literal notranslate"><span class="pre">rebin_energy()</span></code>. You can also <em>bin</em> in time, given a binning function, which returns a <code class="docutils literal notranslate"><span class="pre">TimeEnergyBins</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.binning.unbinned</span> <span class="kn">import</span> <span class="n">bin_by_time</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">eventlist</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">bin_by_time</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c1"># bins the data into 1.0 s wide bins</span>
<span class="nb">type</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span> \
<span class="n">bins</span><span class="o">.</span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(gbm.data.primitives.TimeEnergyBins,
 array([[0., 1., 0., 1.],
        [1., 0., 0., 0.],
        [0., 0., 1., 0.],
        [0., 1., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [1., 0., 0., 1.]]))
</pre></div></div>
</div>
<p>You can also retrieve the exposure for all or part of the EventList. By default, this assumes the deadtime profile for GBM, but can be modified through kwargs:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eventlist</span><span class="o">.</span><span class="n">get_exposure</span><span class="p">(),</span> \
<span class="n">eventlist</span><span class="o">.</span><span class="n">get_exposure</span><span class="p">(</span><span class="n">time_ranges</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(7.7999670000000005, 3.9999796)
</pre></div></div>
</div>
<p>Finally, multiple EventLists can be merged into a single <code class="docutils literal notranslate"><span class="pre">EventList</span></code>. If there is a chance that the EventLists may contain duplicate events, you may want to set the <em>force_unique</em> keyword.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merged_eventlist</span> <span class="o">=</span> <span class="n">EventList</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">time_sliced</span><span class="p">,</span> <span class="n">chan_sliced</span><span class="p">],</span> <span class="n">force_unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">merged_eventlist</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4
</pre></div></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="TimeRange-and-GTI">
<h2>TimeRange and GTI<a class="headerlink" href="#TimeRange-and-GTI" title="Permalink to this headline">¶</a></h2>
<p>These two primitives are designed to represent time ranges (surprise!) and series of time ranges. The <code class="docutils literal notranslate"><span class="pre">TimeRange</span></code> class provides a simple class defining a time range and associated methods. <code class="docutils literal notranslate"><span class="pre">GTI</span></code> (Good Time Intervals) can contain many <code class="docutils literal notranslate"><span class="pre">TimeRanges</span></code>.</p>
<p>Let’s create a <code class="docutils literal notranslate"><span class="pre">TimeRange</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.data.primitives</span> <span class="kn">import</span> <span class="n">TimeRange</span><span class="p">,</span> <span class="n">GTI</span>

<span class="c1"># a time range from 0 s to 10 s</span>
<span class="n">timerange1</span> <span class="o">=</span> <span class="n">TimeRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

<span class="c1"># time range duration and center</span>
<span class="n">timerange1</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> \
<span class="n">timerange1</span><span class="o">.</span><span class="n">center</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(10.0, 5.0)
</pre></div></div>
</div>
<p>You can check to see if it contains a time of interest:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">timerange1</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mf">3.5</span><span class="p">),</span> \
<span class="n">timerange1</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(True, False)
</pre></div></div>
</div>
<p>You can also do simple time range “arithmetic”:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">timerange2</span> <span class="o">=</span> <span class="n">TimeRange</span><span class="p">(</span><span class="mf">4.8</span><span class="p">,</span> <span class="mf">22.0</span><span class="p">)</span>
<span class="n">time_union</span> <span class="o">=</span> <span class="n">TimeRange</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">timerange1</span><span class="p">,</span> <span class="n">timerange2</span><span class="p">)</span>
<span class="n">time_intersect</span> <span class="o">=</span> <span class="n">TimeRange</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">timerange1</span><span class="p">,</span> <span class="n">timerange2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">time_union</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_intersect</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 22.0)
(4.8, 10.0)
</pre></div></div>
</div>
<p>As for <code class="docutils literal notranslate"><span class="pre">GTI</span></code>, you can instantiate it a few different ways. Let’s start with just one range:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gti1</span> <span class="o">=</span> <span class="n">GTI</span><span class="p">(</span><span class="o">*</span><span class="n">timerange1</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">())</span>

<span class="c1"># number of contiguous intervals, full range</span>
<span class="n">gti1</span><span class="o">.</span><span class="n">num_intervals</span><span class="p">,</span> \
<span class="n">gti1</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, (0.0, 10.0))
</pre></div></div>
</div>
<p>And now we can insert a new time range into our <code class="docutils literal notranslate"><span class="pre">GTI</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gti1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mf">23.0</span><span class="p">,</span> <span class="mf">55.0</span><span class="p">)</span> <span class="c1"># insert new interval from 23 s to 55 s</span>
<span class="n">gti1</span><span class="o">.</span><span class="n">num_intervals</span><span class="p">,</span> \
<span class="n">gti1</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, (0.0, 55.0))
</pre></div></div>
</div>
<p>And we can merge two <code class="docutils literal notranslate"><span class="pre">GTI</span></code> into one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># create another GTI from a list of (tstart, tstop) tuples</span>
<span class="n">gti2</span> <span class="o">=</span> <span class="n">GTI</span><span class="o">.</span><span class="n">from_list</span><span class="p">([(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">250.0</span><span class="p">,</span> <span class="mf">275.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">507.0</span><span class="p">,</span> <span class="mf">508.</span><span class="p">)])</span>

<span class="n">gti_merged</span> <span class="o">=</span> <span class="n">GTI</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gti1</span><span class="p">,</span> <span class="n">gti2</span><span class="p">)</span>
<span class="n">gti_merged</span><span class="o">.</span><span class="n">num_intervals</span><span class="p">,</span> \
<span class="n">gti_merged</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5, (0.0, 508.0))
</pre></div></div>
</div>
<p>As with the simple <code class="docutils literal notranslate"><span class="pre">TimeRange</span></code>, we can check to see if a time of interest is contained in the <code class="docutils literal notranslate"><span class="pre">GTI</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gti_merged</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mf">17.0</span><span class="p">),</span> \
<span class="n">gti_merged</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mf">170.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(False, True)
</pre></div></div>
</div>
<p>And if you want to see the full <code class="docutils literal notranslate"><span class="pre">GTI</span></code> intervals:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gti_merged</span><span class="o">.</span><span class="n">as_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(0.0, 10.0), (23.0, 55.0), (100.0, 200.0), (250.0, 275.0), (507.0, 508.0)]
</pre></div></div>
</div>
<hr class="docutils" />
<p>Hopefully your eyes haven’t glazed over yet. If not, you’ve survived the deepest dive into code! Onward to the <a class="reference internal" href="Plugins.html"><span class="doc">plugin architecture and capabilities</span></a>!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Plugins.html" class="btn btn-neutral float-right" title="Plugin-like Architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Simulations.html" class="btn btn-neutral float-left" title="Simulations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright .

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>