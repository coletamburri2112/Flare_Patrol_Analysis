

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>GBM Science Data: Time History Spectra &mdash; GBM Data Tools 1.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
        <script defer="defer" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TTE Data" href="TteData.html" />
    <link rel="prev" title="Jupyter Notebooks" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GBM Data Tools
          

          
            
            <img src="../_static/fermi_face.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Jupyter Notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">GBM Science Data: Time History Spectra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CTIME/CSPEC-data">CTIME/CSPEC data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TteData.html">TTE Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Responses.html">Detector Response Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="PositionHistory.html">The Position History Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Trigdat.html">Quicklook Trigger Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Skymaps.html">GBM Localizations and Sky Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataFinders.html">Finding GBM Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="PhaExport.html">Analysis Workflow: Reduction and Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="SpectralFitting.html">Analysis Workflow: Spectral Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ScatFiles.html">GBM Spectral Catalog Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Simulations.html">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataPrimitives.html">Introduction to the Data Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plugins.html">Plugin-like Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="Visualizations.html">Visualizations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">GBM Data Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Change Logs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GBM Data Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Jupyter Notebooks</a> &raquo;</li>
        
      <li>GBM Science Data: Time History Spectra</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/PhaiiData.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="GBM-Science-Data:-Time-History-Spectra">
<h1>GBM Science Data: Time History Spectra<a class="headerlink" href="#GBM-Science-Data:-Time-History-Spectra" title="Permalink to this headline">¶</a></h1>
<p>The primary science data produced by GBM can be summarized as a time history of spectra, which is provided temporally pre-binned (CTIME and CSPEC) or temporally unbinned (TTE). These data types are produced as “snippets” for every single trigger and are also provided continuously. CTIME and CSPEC are provided in daily chunks, and TTE are provided in hourly chunks (since late 2012). One of the most common things that a user of GBM data wants to do is look at this data (what we call a lightcurve)
for one or more detectors over some energy range. The GBM Data Tools provides high-level functions to enable easy reading and plotting of the GBM data as well as fine-grained functions that expose a variety of attributes and operations for the more advanced user.</p>
<div class="section" id="CTIME/CSPEC-data">
<h2>CTIME/CSPEC data<a class="headerlink" href="#CTIME/CSPEC-data" title="Permalink to this headline">¶</a></h2>
<p>The CTIME and CSPEC data are temporally pre-binned data, which have 8 and 128 energy channels respectively. Our “Hello, World!” for the GBM Data Tools is successfully opening/reading one of these files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#### our test data directory</span>
<span class="kn">from</span> <span class="nn">gbm</span> <span class="kn">import</span> <span class="n">test_data_dir</span>
<span class="c1"># import the CTIME and CSPEC data classes</span>
<span class="kn">from</span> <span class="nn">gbm.data</span> <span class="kn">import</span> <span class="n">Ctime</span><span class="p">,</span> <span class="n">Cspec</span>

<span class="c1"># read a ctime file</span>
<span class="n">ctime</span> <span class="o">=</span> <span class="n">Ctime</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">test_data_dir</span><span class="o">+</span><span class="s1">&#39;/glg_ctime_nb_bn120415958_v00.pha&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ctime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
glg_ctime_nb_bn120415958_v00.pha
</pre></div></div>
</div>
<p>Since GBM uses the FITS format, the data files have multiple data extensions, each with metadata information in a “header.” There is also a primary header that contains metadata relevant to the overall file. You can access this metadata information:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># list the headers in the file</span>
<span class="n">ctime</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
odict_keys([&#39;PRIMARY&#39;, &#39;EBOUNDS&#39;, &#39;SPECTRUM&#39;, &#39;GTI&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># print the metadata in the PRIMARY header</span>
<span class="n">ctime</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;PRIMARY&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIMPLE  =                    T / file does conform to FITS standard
BITPIX  =                    8 / number of bits per data pixel
NAXIS   =                    0 / number of data axes
EXTEND  =                    T / FITS dataset may contain extensions
COMMENT   FITS (Flexible Image Transport System) format is defined in &#39;Astronomy
COMMENT   and Astrophysics&#39;, volume 376, page 359; bibcode: 2001A&amp;A...376..359H
CREATOR = &#39;GBM_SCI_Reader.pl v1.19&#39; / Software and version creating file
FILETYPE= &#39;PHAII   &#39;           / Name for this type of FITS file
FILE-VER= &#39;1.0.0   &#39;           / Version of the format for this filetype
TELESCOP= &#39;GLAST   &#39;           / Name of mission/satellite
INSTRUME= &#39;GBM     &#39;           / Specific instrument used for observation
DETNAM  = &#39;NAI_11  &#39;           / Individual detector name
OBSERVER= &#39;Meegan  &#39;           / GLAST Burst Monitor P.I.
ORIGIN  = &#39;GIOC    &#39;           / Name of organization making file
DATE    = &#39;2012-04-16T02:15:21&#39; / file creation date (YYYY-MM-DDThh:mm:ss UT)
DATE-OBS= &#39;2012-04-15T22:44:21&#39; / Date of start of observation
DATE-END= &#39;2012-04-15T23:16:01&#39; / Date of end of observation
TIMESYS = &#39;TT      &#39;           / Time system used in time keywords
TIMEUNIT= &#39;s       &#39;           / Time since MJDREF, used in TSTART and TSTOP
MJDREFI =                51910 / MJD of GLAST reference epoch, integer part
MJDREFF = 7.428703703703703D-4 / MJD of GLAST reference epoch, fractional part
TSTART  =     356222661.790904 / [GLAST MET] Observation start time
TSTOP   =     356224561.991216 / [GLAST MET] Observation stop time
FILENAME= &#39;glg_ctime_nb_bn120415958_v00.pha&#39; / Name of this file
DATATYPE= &#39;CTIME   &#39;           / GBM datatype used for this file
TRIGTIME=     356223561.133346 / Trigger time relative to MJDREF, double precisi
OBJECT  = &#39;GRB120415958&#39;       / Burst name in standard format, yymmddfff
RADECSYS= &#39;FK5     &#39;           / Stellar reference frame
EQUINOX =               2000.0 / Equinox for RA and Dec
RA_OBJ  =              30.0000 / Calculated RA of burst
DEC_OBJ =              -15.000 / Calculated Dec of burst
ERR_RAD =                3.000 / Calculated Location Error Radius
INFILE01= &#39;glg_lutct_nai_100716346_v00.fit&#39; / Level 1 input lookup table file
INFILE02= &#39;GLAST_2012106_220700_VC09_GTIME.0.00&#39; / Level 0 input data file
INFILE03= &#39;GLAST_2012107_014000_VC09_GTIME.0.00&#39; / Level 0 input data file
CHECKSUM= &#39;GJaaGGaTGGaZGGaZ&#39;   / HDU checksum updated 2012-04-16T02:24:24
DATASUM = &#39;         0&#39;         / data unit checksum updated 2012-04-16T02:15:21
</pre></div></div>
</div>
<p>You can access the values in the headers using the traditional <code class="docutils literal notranslate"><span class="pre">`astropy.fits.io</span></code> &lt;<a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/">https://docs.astropy.org/en/stable/io/fits/</a>&gt;`__ syntax, There is also easy access for certain important properties:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># certain useful properties are easily accessible</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GTI: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctime</span><span class="o">.</span><span class="n">gti</span><span class="p">))</span>  <span class="c1"># the good time intervals for the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trigger time: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctime</span><span class="o">.</span><span class="n">trigtime</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time Range: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctime</span><span class="o">.</span><span class="n">time_range</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Energy Range: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctime</span><span class="o">.</span><span class="n">energy_range</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# of Energy Channels: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctime</span><span class="o">.</span><span class="n">numchans</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GTI: [(-899.3424419760704, 1000.8578699827194)]
Trigger time: 356223561.133346
Time Range: (-899.3424419760704, 1000.8578699827194)
Energy Range: (4.323754, 2000.0)
# of Energy Channels: 8
</pre></div></div>
</div>
<p>The CTIME/CSPEC data objects are modeled as wrappers around the <a class="reference internal" href="DataPrimitives.html"><span class="doc">Data Primitives</span></a> in <code class="docutils literal notranslate"><span class="pre">gbm.data.primitives</span></code>, and the underlying data can be accessed via the <code class="docutils literal notranslate"><span class="pre">.data</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ctime</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;gbm.data.primitives.TimeEnergyBins at 0x120a5aa90&gt;
</pre></div></div>
</div>
<p>Most casual users need not directly worry about the Data Primitives, though. The CTIME/CSPEC data objects contain the high-level functionality to perform a lot of common data reduction. For example, if we only want to work with a short time segment of data in the file, we can take a slice of the data and return a new fully-functional data object with the time-sliced data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># slice from approx. -10 to +10 s</span>
<span class="n">time_sliced_ctime</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">slice_time</span><span class="p">((</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
<span class="n">time_sliced_ctime</span><span class="o">.</span><span class="n">time_range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-10.240202009677887, 10.048128008842468)
</pre></div></div>
</div>
<p>Or you can take a slice of the data in energy:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># slice from ~50 keV to ~300 keV</span>
<span class="n">energy_sliced_ctime</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">slice_energy</span><span class="p">((</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">))</span>
<span class="n">energy_sliced_ctime</span><span class="o">.</span><span class="n">energy_range</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(49.60019, 538.1436)
</pre></div></div>
</div>
<p>As mentioned, this data is 2-dimensional, so what do we do if we want a lightcurve covering a particular energy range? You would integrate (sum) over energy, and you can easily do this with the <code class="docutils literal notranslate"><span class="pre">to_lightcurve()</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over the full energy range</span>
<span class="n">lightcurve</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">to_lightcurve</span><span class="p">()</span>

<span class="c1"># the lightcurve bin centroids and count rates</span>
<span class="n">lightcurve</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">.</span><span class="n">rates</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([-899.21444198, -898.95853901, -898.70263603, ..., 1000.21786997,
        1000.47386995, 1000.72986996]),
 array([   0.    , 1186.1779, 1596.2815, ..., 1168.0736, 1136.9364,
        1160.156 ], dtype=float32))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over 50-300 keV</span>
<span class="n">lightcurve</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">to_lightcurve</span><span class="p">(</span><span class="n">energy_range</span><span class="o">=</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">))</span>
<span class="c1"># the lightcurve bin centroids and count rates</span>
<span class="n">lightcurve</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">.</span><span class="n">rates</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([-899.21444198, -898.95853901, -898.70263603, ..., 1000.21786997,
        1000.47386995, 1000.72986996]),
 array([  0.     , 223.88126, 439.27155, ..., 466.4455 , 380.28564,
        437.49994], dtype=float32))
</pre></div></div>
</div>
<p>“Ok, that’s cool, but how do I make a plot of the lightcurve?” To do that, you need to import the <code class="docutils literal notranslate"><span class="pre">Lightcurve</span></code> class from the <code class="docutils literal notranslate"><span class="pre">gbm.plot</span></code> module:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">gbm.plot</span> <span class="kn">import</span> <span class="n">Lightcurve</span>
<span class="n">lcplot</span> <span class="o">=</span> <span class="n">Lightcurve</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lightcurve</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_PhaiiData_18_0.png" src="../_images/notebooks_PhaiiData_18_0.png" />
</div>
</div>
<p>What…is going on there? Well, we are reading a trigger CTIME file, so normally the CTIME data is accumulated in 256 ms duration bins, but starting at trigger time, the data switches to 64 ms duration bins for several hundred seconds, and then it goes back to 256 ms bins.</p>
<p>So maybe the native CTIME resolution is overkill because it’s hard to see the signal. If only we could rebin the data to a lower resolution…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># the data binning module</span>
<span class="kn">from</span> <span class="nn">gbm.binning.binned</span> <span class="kn">import</span> <span class="n">rebin_by_time</span>

<span class="c1"># rebin the data to 2048 ms resolution</span>
<span class="n">rebinned_ctime</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">rebin_time</span><span class="p">(</span><span class="n">rebin_by_time</span><span class="p">,</span> <span class="mf">2.048</span><span class="p">)</span>

<span class="c1"># and replot</span>
<span class="n">lcplot</span> <span class="o">=</span> <span class="n">Lightcurve</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rebinned_ctime</span><span class="o">.</span><span class="n">to_lightcurve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_PhaiiData_20_0.png" src="../_images/notebooks_PhaiiData_20_0.png" />
</div>
</div>
<p>And voila! We can now easily see the GRB signal in the lightcurve, Of course you’d probably want to zoom in to see it better, but we will talk about the plotting functionality a little later. If you are working in ipython, you can make these plots interactively, zooming and panning to your heart’s content.</p>
<p>You can also just as easily create a count spectrum (integrating over time):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over the full time range</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">to_spectrum</span><span class="p">()</span>
<span class="c1"># the energy channel centroids and differential count rates</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">rates</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([   7.04047 ,   17.340723,   36.069298,   70.78455 ,  171.29333 ,
         395.36002 ,  732.5708  , 1412.2628  ], dtype=float32),
 array([ 8.58324638, 21.62204574,  9.88407582,  3.26465078,  1.09189102,
         0.2609349 ,  0.10644744,  0.07470517]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over the time range (-10.0, +10.0)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">to_spectrum</span><span class="p">(</span><span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
<span class="c1"># the energy channel centroids and differential count rates</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">centroids</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">rates</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([   7.04047 ,   17.340723,   36.069298,   70.78455 ,  171.29333 ,
         395.36002 ,  732.5708  , 1412.2628  ], dtype=float32),
 array([ 8.63882267, 22.40915926, 10.84130467,  3.48270155,  1.08284141,
         0.23386863,  0.10268272,  0.06447497]))
</pre></div></div>
</div>
<p>And the corresponding plot for the count spectrum can be made using the <code class="docutils literal notranslate"><span class="pre">Spectrum</span></code> class from the <code class="docutils literal notranslate"><span class="pre">gbm.plot</span></code> model thusly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm.plot</span> <span class="kn">import</span> <span class="n">Spectrum</span>
<span class="n">specplot</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">spectrum</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_PhaiiData_26_0.png" src="../_images/notebooks_PhaiiData_26_0.png" />
</div>
</div>
<p>Ok, so maybe not quite as interesting as the lightcurve, since CTIME is only 8-channel data after all. The count spectra for CSPEC and TTE are much prettier. It’s worth noting here that this spectrum is integrated over the full duration of the data, so perhaps you are interesting in a particular time range of data. You can make a single-spectrum PHA object like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># integrate over a single time selection</span>
<span class="n">pha1</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">to_pha</span><span class="p">(</span><span class="n">time_ranges</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)])</span>
<span class="c1"># integrate over multiple time selections</span>
<span class="n">pha2</span> <span class="o">=</span> <span class="n">ctime</span><span class="o">.</span><span class="n">to_pha</span><span class="p">(</span><span class="n">time_ranges</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<p>Let’s revisit our time-sliced CTIME object. Maybe we are doing some sort of analysis using the GBM continuous data and we don’t want to save the full day’s worth of data for our analysis. We can write our sliced CTIME object to a fully-qualified FITS file following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">time_sliced_ctime</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;my_first_custom_ctime.pha&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Everything that we’ve done here with a CTIME data can be done with CSPEC data by simply using <code class="docutils literal notranslate"><span class="pre">Cspec.open()</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Ctime.open()</span></code></p>
<p>Now to learn about GBM TTE data head, on over to <a class="reference internal" href="TteData.html"><span class="doc">here</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="TteData.html" class="btn btn-neutral float-right" title="TTE Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Jupyter Notebooks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright .

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>